<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:ns1="http://sozi.baierouge.fr"
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="704.27161"
   height="537.521"
   id="svg2"
   version="1.1"
   inkscape:version="0.48.3.1 r9886"
   sodipodi:docname="sozi-links-tutorial-full.svg">
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.98994949"
     inkscape:cx="379.87291"
     inkscape:cy="275.90773"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     inkscape:window-width="905"
     inkscape:window-height="764"
     inkscape:window-x="0"
     inkscape:window-y="45"
     inkscape:window-maximized="0"
     units="cm"
     fit-margin-top="1"
     fit-margin-right="1"
     fit-margin-left="1"
     fit-margin-bottom="1" />
  <defs
     id="defs4" />
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title />
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Calque 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(3.7789685,-19.500538)">
    <g
       id="text5916"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#ff0000;fill-opacity:1;stroke:none;font-family:Purisa;-inkscape-font-specification:Purisa">
      <path
         id="path6612"
         d="m 157.08228,151.00559 c 0,-0.27198 0.36,-0.81598 1.08,-1.632 0.72,-0.81598 1.176,-1.22398 1.368,-1.224 0.62399,2e-5 1.95999,0.12802 4.008,0.384 2.04799,0.25602 3.26399,0.44802 3.648,0.576 1.07199,0.30402 1.60799,1.03202 1.608,2.184 -10e-6,0.54402 -0.13601,1.10402 -0.408,1.68 -0.25601,0.56002 -0.54401,1.03202 -0.864,1.416 -0.32001,0.36801 -0.61601,0.71201 -0.888,1.032 -0.25601,0.32001 -0.38401,0.52001 -0.384,0.6 -1e-5,0.11201 -0.46401,0.47201 -1.392,1.08 -0.91201,0.59201 -1.72001,1.07201 -2.424,1.44 -0.57601,0.32001 -0.86401,0.52001 -0.864,0.6 -1e-5,0.032 0.29599,0.15201 0.888,0.36 0.60799,0.19201 1.33599,0.45601 2.184,0.792 0.84799,0.33601 1.50399,0.66401 1.968,0.984 0.73599,0.51201 1.18399,0.76801 1.344,0.768 0.22399,0.016 0.58399,0.28801 1.08,0.816 0.51199,0.51201 0.76799,0.88001 0.768,1.104 -1e-5,0.40001 -0.14401,0.60001 -0.432,0.6 -0.25601,1e-5 -0.68801,-0.15999 -1.296,-0.48 -0.59201,-0.31999 -1.36801,-0.73599 -2.328,-1.248 -0.94401,-0.52799 -1.84001,-0.95199 -2.688,-1.272 l -1.872,-0.744 0.096,2.808 c 0.016,0.43201 0.024,0.93601 0.024,1.512 -10e-6,0.032 -10e-6,0.08 0,0.144 -10e-6,0.304 -0.008,0.52 -0.024,0.648 -0.016,0.144 -0.072,0.272 -0.168,0.384 -0.096,0.128 -0.24801,0.192 -0.456,0.192 -0.60801,0 -0.912,-0.976 -0.912,-2.928 0,-2.04799 -0.328,-3.22399 -0.984,-3.528 -0.48,-0.20799 -0.72,-0.49599 -0.72,-0.864 0,-0.33599 0.232,-0.61599 0.696,-0.84 l 0.792,-0.36 -0.192,-2.736 c -0.096,-1.45598 -0.2,-2.46398 -0.312,-3.024 -0.096,-0.57598 -0.232,-0.86398 -0.408,-0.864 -0.048,2e-5 -0.144,0.056 -0.288,0.168 -0.144,0.11202 -0.32,0.16802 -0.528,0.168 -0.192,2e-5 -0.36,-0.064 -0.504,-0.192 -0.144,-0.12798 -0.216,-0.29598 -0.216,-0.504 m 10.296,0.12 c -1e-5,-0.064 -0.016,-0.11198 -0.048,-0.144 -0.032,-0.032 -0.18401,-0.096 -0.456,-0.192 -0.25601,-0.096 -0.68001,-0.22398 -1.272,-0.384 -1.08801,-0.30398 -2.19201,-0.45598 -3.312,-0.456 l -1.728,0 0.168,1.296 c 0.048,0.32002 0.11999,1.00002 0.216,2.04 0.096,1.02402 0.18399,1.93601 0.264,2.736 0.08,0.78401 0.13599,1.17601 0.168,1.176 0.22399,1e-5 0.81599,-0.26399 1.776,-0.792 0.95999,-0.52799 1.63199,-0.96799 2.016,-1.32 0.41599,-0.36799 0.88799,-1.03198 1.416,-1.992 0.52799,-0.95998 0.79199,-1.61598 0.792,-1.968"
         inkscape:connector-curvature="0" />
      <path
         id="path6614"
         d="m 184.62753,160.77359 c 0.08,10e-6 0.11999,0.064 0.12,0.192 -1e-5,0.28801 -0.21601,0.75201 -0.648,1.392 -0.41601,0.64001 -0.86401,1.16801 -1.344,1.584 -1.68001,1.488 -3.36001,2.232 -5.04,2.232 -0.64001,0 -1.28001,-0.144 -1.92,-0.432 -0.62401,-0.304 -1.208,-0.728 -1.752,-1.272 -0.544,-0.54399 -0.984,-1.27199 -1.32,-2.184 -0.336,-0.91199 -0.504,-1.92799 -0.504,-3.048 0,-0.68799 0.08,-1.27199 0.24,-1.752 0.32,-0.97599 1,-2.00799 2.04,-3.096 1.05599,-1.08798 2.04799,-1.63198 2.976,-1.632 0.25599,2e-5 0.63999,0.024 1.152,0.072 0.76799,0.064 1.30399,0.14402 1.608,0.24 0.31999,0.096 0.67999,0.29602 1.08,0.6 0.51199,0.38402 0.95199,0.88002 1.32,1.488 0.38399,0.59201 0.57599,1.08801 0.576,1.488 -1e-5,0.51201 -0.20001,0.90401 -0.6,1.176 -0.40001,0.25601 -1.17601,0.51201 -2.328,0.768 -1.48801,0.33601 -2.96001,0.54401 -4.416,0.624 l -2.232,0.12 0,0.96 c 0,1.18401 0.552,2.30401 1.656,3.36 0.83199,0.80001 1.69599,1.2 2.592,1.2 0.68799,0 1.41599,-0.20799 2.184,-0.624 0.78399,-0.43199 1.44799,-0.90399 1.992,-1.416 0.54399,-0.51199 1.06399,-0.97599 1.56,-1.392 0.49599,-0.43199 0.83199,-0.64799 1.008,-0.648 m -3.864,-5.856 c -0.49601,-0.44798 -0.87201,-0.72798 -1.128,-0.84 -0.24001,-0.12798 -0.56001,-0.19198 -0.96,-0.192 -0.80001,2e-5 -1.40001,0.08 -1.8,0.24 -0.38401,0.14402 -0.77601,0.44802 -1.176,0.912 -1.216,1.39201 -1.824,2.32001 -1.824,2.784 0,0.20801 0.192,0.31201 0.576,0.312 1.45599,1e-5 3.51999,-0.30399 6.192,-0.912 0.79999,-0.19199 1.19999,-0.52799 1.2,-1.008 -10e-6,-0.22399 -0.36001,-0.65599 -1.08,-1.296"
         inkscape:connector-curvature="0" />
      <path
         id="path6616"
         d="m 201.19203,166.17359 c -2e-5,0.352 -0.072,0.624 -0.216,0.816 -0.12802,0.208 -0.24802,0.328 -0.36,0.36 -0.096,0.048 -0.18402,0.072 -0.264,0.072 -0.20802,0 -0.38401,-0.072 -0.528,-0.216 -0.14401,-0.128 -0.25601,-0.368 -0.336,-0.72 -0.08,-0.336 -0.13601,-0.592 -0.168,-0.768 -0.016,-0.176 -0.048,-0.504 -0.096,-0.984 -0.11201,-1.61599 -0.24001,-2.42399 -0.384,-2.424 -0.17601,1e-5 -0.45601,0.23201 -0.84,0.696 -1.79201,2.112 -3.68001,3.168 -5.664,3.168 -0.59201,0 -1.18401,-0.112 -1.776,-0.336 -2.048,-0.768 -3.072,-2.33599 -3.072,-4.704 0,-1.02399 0.168,-1.99999 0.504,-2.928 0.352,-0.94399 0.792,-1.73599 1.32,-2.376 0.544,-0.63999 1.08799,-1.17598 1.632,-1.608 0.54399,-0.43198 1.06399,-0.73598 1.56,-0.912 0.62399,-0.23998 1.05599,-0.35998 1.296,-0.36 0.41599,2e-5 1.11199,0.27202 2.088,0.816 0.99199,0.54402 1.67999,1.07201 2.064,1.584 0.43199,0.57601 0.75999,0.86401 0.984,0.864 0.016,1e-5 0.024,1e-5 0.024,0 -1e-5,-0.016 0.008,-0.024 0.024,-0.024 0.17599,-0.11199 0.26399,-2.19998 0.264,-6.264 -1e-5,-4.01598 0.096,-6.29597 0.288,-6.84 0.20799,-0.49597 0.51998,-0.74397 0.936,-0.744 l 0.648,0 -0.192,9.864 c -0.048,2.44802 -0.072,4.63201 -0.072,6.552 -2e-5,2.60801 0.056,4.47201 0.168,5.592 0.11198,1.12 0.16798,1.728 0.168,1.824 m -5.616,-10.632 c -0.94401,-0.62399 -1.60001,-0.93598 -1.968,-0.936 -0.32001,2e-5 -1.04001,0.54401 -2.16,1.632 -1.12001,1.08801 -1.784,1.88801 -1.992,2.4 -0.16,0.38401 -0.24,1.08001 -0.24,2.088 0,1.23201 0.104,2.03201 0.312,2.4 0.16,0.28801 0.54399,0.60001 1.152,0.936 0.62399,0.33601 1.23999,0.50401 1.848,0.504 1.08799,1e-5 2.46399,-0.79999 4.128,-2.4 1.31199,-1.26399 1.96799,-2.08799 1.968,-2.472 -1e-5,-0.52799 -0.33601,-1.23199 -1.008,-2.112 -0.65601,-0.87999 -1.33601,-1.55999 -2.04,-2.04"
         inkscape:connector-curvature="0" />
    </g>
    <g
       id="text5920"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#008000;fill-opacity:1;stroke:none;font-family:Purisa;-inkscape-font-specification:Purisa">
      <path
         id="path6601"
         d="m 498.35774,156.96328 c -0.51201,1e-5 -1.01601,-0.096 -1.512,-0.288 -0.49601,-0.19199 -0.74401,-0.50399 -0.744,-0.936 -1e-5,-0.27199 0.11999,-0.47999 0.36,-0.624 0.23999,-0.14399 0.51199,-0.26399 0.816,-0.36 0.30399,-0.096 0.49599,-0.21599 0.576,-0.36 0.08,-0.12798 0.35999,-0.19198 0.84,-0.192 0.62399,2e-5 1.35999,0.096 2.208,0.288 0.84798,0.19201 1.40798,0.40001 1.68,0.624 0.46398,0.38401 0.81598,1.35201 1.056,2.904 0.25598,1.55201 0.38398,3.33601 0.384,5.352 -2e-5,1.056 -0.14402,1.68 -0.432,1.872 -0.12802,0.112 -0.27202,0.168 -0.432,0.168 -0.16002,0 -0.32802,-0.08 -0.504,-0.24 -0.32002,-0.304 -0.48002,-1.34399 -0.48,-3.12 l 0,-2.736 -0.768,1.272 c -0.91202,1.50401 -1.94401,2.68001 -3.096,3.528 -1.15201,0.832 -2.26401,1.248 -3.336,1.248 -0.62401,0 -1.20801,-0.152 -1.752,-0.456 -0.41601,-0.224 -0.72801,-0.488 -0.936,-0.792 -0.19201,-0.31999 -0.39201,-0.87199 -0.6,-1.656 -0.24001,-0.83199 -0.36001,-1.59199 -0.36,-2.28 -10e-6,-0.47999 0.048,-1.11199 0.144,-1.896 0.15999,-1.27999 0.38399,-2.28799 0.672,-3.024 0.30399,-0.73599 0.88799,-1.74398 1.752,-3.024 0.60799,-0.89598 1.27199,-1.66398 1.992,-2.304 0.71999,-0.63998 1.33599,-1.07998 1.848,-1.32 0.52799,-0.23998 0.99999,-0.46398 1.416,-0.672 0.43199,-0.22398 0.69599,-0.41598 0.792,-0.576 0.15999,-0.27198 0.56798,-0.40798 1.224,-0.408 0.70398,2e-5 1.27998,0.15202 1.728,0.456 0.46398,0.28802 0.69598,0.58402 0.696,0.888 -2e-5,0.19202 -0.096,0.48002 -0.288,0.864 -0.19202,0.36802 -0.39202,0.55202 -0.6,0.552 -0.17602,2e-5 -0.32002,-0.18398 -0.432,-0.552 -0.11202,-0.38398 -0.28802,-0.57598 -0.528,-0.576 -0.24002,2e-5 -0.54402,0.048 -0.912,0.144 -0.36802,0.096 -0.84001,0.29602 -1.416,0.6 -0.56001,0.30402 -1.12801,0.68002 -1.704,1.128 -0.56001,0.44802 -1.16801,1.08002 -1.824,1.896 -0.65601,0.80002 -1.24801,1.71202 -1.776,2.736 -0.48001,0.92801 -0.77601,1.62401 -0.888,2.088 -0.11201,0.46401 -0.16801,1.24001 -0.168,2.328 -1e-5,1.56801 0.13599,2.64001 0.408,3.216 0.27199,0.56001 0.78399,0.84001 1.536,0.84 1.59999,1e-5 2.91999,-0.68799 3.96,-2.064 0.51199,-0.68799 0.95199,-1.43199 1.32,-2.232 0.36798,-0.79999 0.55198,-1.40799 0.552,-1.824 -2e-5,-0.25599 -0.10402,-0.47999 -0.312,-0.672 -0.19201,-0.20799 -0.39201,-0.31199 -0.6,-0.312 -0.12801,1e-5 -0.30401,0.088 -0.528,0.264 -0.20801,0.16001 -0.55201,0.24001 -1.032,0.24"
         inkscape:connector-curvature="0" />
      <path
         id="path6603"
         d="m 516.00299,153.55528 c 0.27199,2e-5 0.51199,0.088 0.72,0.264 0.20799,0.16002 0.31199,0.29602 0.312,0.408 -10e-6,0.19201 -0.30401,0.40801 -0.912,0.648 -0.99201,0.40001 -2.00801,1.36801 -3.048,2.904 -1.02401,1.52001 -1.64801,2.99201 -1.872,4.416 -0.25601,1.61601 -0.46401,2.672 -0.624,3.168 -0.16001,0.512 -0.36801,0.768 -0.624,0.768 -0.22401,0 -0.40001,-0.08 -0.528,-0.24 -0.11201,-0.16 -0.19201,-0.336 -0.24,-0.528 -0.032,-0.192 -0.072,-0.544 -0.12,-1.056 -0.016,-0.096 -0.024,-0.16799 -0.024,-0.216 -0.38401,-4.03199 -0.57601,-7.21599 -0.576,-9.552 -1e-5,-0.83198 0.032,-1.34398 0.096,-1.536 0.17599,-0.51198 0.39999,-0.76798 0.672,-0.768 0.25599,2e-5 0.38399,0.21602 0.384,0.648 -10e-6,0.72002 0.11199,1.88001 0.336,3.48 0.22399,1.60001 0.39199,2.40001 0.504,2.4 0.14399,1e-5 0.43999,-0.43999 0.888,-1.32 0.55999,-1.03999 1.30399,-1.94399 2.232,-2.712 0.94399,-0.78398 1.75199,-1.17598 2.424,-1.176"
         inkscape:connector-curvature="0" />
      <path
         id="path6605"
         d="m 532.30836,160.05928 c 0.08,1e-5 0.11999,0.064 0.12,0.192 -10e-6,0.28801 -0.21601,0.75201 -0.648,1.392 -0.41601,0.64001 -0.86401,1.16801 -1.344,1.584 -1.68001,1.488 -3.36001,2.232 -5.04,2.232 -0.64,0 -1.28,-0.144 -1.92,-0.432 -0.624,-0.304 -1.208,-0.728 -1.752,-1.272 -0.544,-0.54399 -0.984,-1.27199 -1.32,-2.184 -0.336,-0.91199 -0.504,-1.92799 -0.504,-3.048 0,-0.68799 0.08,-1.27199 0.24,-1.752 0.32,-0.97599 1,-2.00799 2.04,-3.096 1.056,-1.08798 2.048,-1.63198 2.976,-1.632 0.25599,2e-5 0.63999,0.024 1.152,0.072 0.76799,0.064 1.30399,0.14402 1.608,0.24 0.31999,0.096 0.67999,0.29602 1.08,0.6 0.51199,0.38402 0.95199,0.88002 1.32,1.488 0.38399,0.59201 0.57599,1.08801 0.576,1.488 -1e-5,0.51201 -0.20001,0.90401 -0.6,1.176 -0.40001,0.25601 -1.17601,0.51201 -2.328,0.768 -1.48801,0.33601 -2.96001,0.54401 -4.416,0.624 l -2.232,0.12 0,0.96 c 0,1.18401 0.552,2.30401 1.656,3.36 0.832,0.80001 1.696,1.20001 2.592,1.2 0.68799,10e-6 1.41599,-0.20799 2.184,-0.624 0.78399,-0.43199 1.44799,-0.90399 1.992,-1.416 0.54399,-0.51199 1.06399,-0.97599 1.56,-1.392 0.49599,-0.43199 0.83199,-0.64799 1.008,-0.648 m -3.864,-5.856 c -0.49601,-0.44798 -0.87201,-0.72798 -1.128,-0.84 -0.24001,-0.12798 -0.56001,-0.19198 -0.96,-0.192 -0.80001,2e-5 -1.40001,0.08 -1.8,0.24 -0.384,0.14402 -0.776,0.44802 -1.176,0.912 -1.216,1.39201 -1.824,2.32001 -1.824,2.784 0,0.20801 0.192,0.31201 0.576,0.312 1.456,1e-5 3.51999,-0.30399 6.192,-0.912 0.79999,-0.19199 1.19999,-0.52799 1.2,-1.008 -10e-6,-0.22399 -0.36001,-0.65599 -1.08,-1.296"
         inkscape:connector-curvature="0" />
      <path
         id="path6607"
         d="m 547.12086,160.05928 c 0.08,1e-5 0.11999,0.064 0.12,0.192 -10e-6,0.28801 -0.21601,0.75201 -0.648,1.392 -0.41601,0.64001 -0.86401,1.16801 -1.344,1.584 -1.68001,1.488 -3.36001,2.232 -5.04,2.232 -0.64,0 -1.28,-0.144 -1.92,-0.432 -0.624,-0.304 -1.208,-0.728 -1.752,-1.272 -0.544,-0.54399 -0.984,-1.27199 -1.32,-2.184 -0.336,-0.91199 -0.504,-1.92799 -0.504,-3.048 0,-0.68799 0.08,-1.27199 0.24,-1.752 0.32,-0.97599 1,-2.00799 2.04,-3.096 1.056,-1.08798 2.048,-1.63198 2.976,-1.632 0.25599,2e-5 0.63999,0.024 1.152,0.072 0.76799,0.064 1.30399,0.14402 1.608,0.24 0.31999,0.096 0.67999,0.29602 1.08,0.6 0.51199,0.38402 0.95199,0.88002 1.32,1.488 0.38399,0.59201 0.57599,1.08801 0.576,1.488 -1e-5,0.51201 -0.20001,0.90401 -0.6,1.176 -0.40001,0.25601 -1.17601,0.51201 -2.328,0.768 -1.48801,0.33601 -2.96001,0.54401 -4.416,0.624 l -2.232,0.12 0,0.96 c 0,1.18401 0.552,2.30401 1.656,3.36 0.832,0.80001 1.696,1.20001 2.592,1.2 0.68799,10e-6 1.41599,-0.20799 2.184,-0.624 0.78399,-0.43199 1.44799,-0.90399 1.992,-1.416 0.54399,-0.51199 1.06399,-0.97599 1.56,-1.392 0.49599,-0.43199 0.83199,-0.64799 1.008,-0.648 m -3.864,-5.856 c -0.49601,-0.44798 -0.87201,-0.72798 -1.128,-0.84 -0.24001,-0.12798 -0.56001,-0.19198 -0.96,-0.192 -0.80001,2e-5 -1.40001,0.08 -1.8,0.24 -0.384,0.14402 -0.776,0.44802 -1.176,0.912 -1.216,1.39201 -1.824,2.32001 -1.824,2.784 0,0.20801 0.192,0.31201 0.576,0.312 1.456,1e-5 3.51999,-0.30399 6.192,-0.912 0.79999,-0.19199 1.19999,-0.52799 1.2,-1.008 -10e-6,-0.22399 -0.36001,-0.65599 -1.08,-1.296"
         inkscape:connector-curvature="0" />
      <path
         id="path6609"
         d="m 551.32536,152.23528 c 0,-0.54398 0.16,-0.81598 0.48,-0.816 0.208,2e-5 0.36,0.24002 0.456,0.72 0.096,0.46402 0.272,1.85602 0.528,4.176 0.32,2.59201 0.488,3.90401 0.504,3.936 0.016,0.016 0.08,-0.13599 0.192,-0.456 0.128,-0.33599 0.296,-0.83199 0.504,-1.488 0.32,-1.05599 0.59199,-1.81599 0.816,-2.28 0.22399,-0.47999 0.62399,-1.13599 1.2,-1.968 1.16799,-1.61598 2.07199,-2.42398 2.712,-2.424 0.41599,2e-5 0.80799,0.28002 1.176,0.84 0.49599,0.73602 0.79999,1.46402 0.912,2.184 0.11199,0.72001 0.19199,2.42401 0.24,5.112 0.032,1.72801 0.048,2.75201 0.048,3.072 -10e-6,0.80001 -0.032,1.38401 -0.096,1.752 -0.048,0.352 -0.12801,0.568 -0.24,0.648 -0.096,0.096 -0.27201,0.152 -0.528,0.168 -0.14401,0 -0.24001,-0.064 -0.288,-0.192 -0.048,-0.112 -0.072,-0.384 -0.072,-0.816 -10e-6,-0.23999 0.016,-0.75199 0.048,-1.536 0.032,-0.79999 0.048,-1.47199 0.048,-2.016 -1e-5,-1.35999 -0.056,-2.68799 -0.168,-3.984 -0.096,-1.31199 -0.21601,-2.15199 -0.36,-2.52 -0.08,-0.20798 -0.20801,-0.42398 -0.384,-0.648 -0.17601,-0.22398 -0.34401,-0.33598 -0.504,-0.336 -0.33601,2e-5 -0.87201,0.57602 -1.608,1.728 -0.73601,1.13601 -1.36801,2.33601 -1.896,3.6 -0.49601,1.15201 -0.832,2.04001 -1.008,2.664 -0.16,0.60801 -0.296,1.44001 -0.408,2.496 -0.176,1.632 -0.304,2.448 -0.384,2.448 -0.128,0 -0.312,-0.136 -0.552,-0.408 -0.176,-0.176 -0.296,-0.552 -0.36,-1.128 -0.064,-0.59199 -0.152,-1.75199 -0.264,-3.48 -0.112,-1.74399 -0.264,-3.50399 -0.456,-5.28 -0.192,-1.83998 -0.288,-3.09598 -0.288,-3.768"
         inkscape:connector-curvature="0" />
    </g>
    <g
       id="text5924"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#0000ff;fill-opacity:1;stroke:none;font-family:Purisa;-inkscape-font-specification:Purisa">
      <path
         id="path6577"
         d="m 168.58629,413.21471 c -0.208,0 -0.504,0.072 -0.888,0.216 -0.384,0.128 -0.664,0.192 -0.84,0.192 -0.208,0 -0.384,-0.072 -0.528,-0.216 -0.128,-0.16 -0.24,-0.392 -0.336,-0.696 -0.08,-0.32 -0.144,-0.68 -0.192,-1.08 -0.048,-0.4 -0.096,-0.896 -0.144,-1.488 -0.032,-0.592 -0.072,-1.18399 -0.12,-1.776 -0.032,-0.59199 -0.088,-1.29599 -0.168,-2.112 -0.064,-0.83199 -0.144,-1.62399 -0.24,-2.376 -0.176,-1.58399 -0.312,-2.97599 -0.408,-4.176 l -0.168,-2.16 -0.936,0 c -0.8,2e-5 -1.2,-0.17598 -1.2,-0.528 0,-0.51198 1.232,-1.08798 3.696,-1.728 0.992,-0.25598 2.448,-0.38398 4.368,-0.384 0.73599,2e-5 1.22399,0.04 1.464,0.12 0.25599,0.064 0.51199,0.23202 0.768,0.504 0.39999,0.46402 0.59999,0.84002 0.6,1.128 -1e-5,0.73602 -0.20801,1.52002 -0.624,2.352 -0.40001,0.83201 -0.80801,1.53601 -1.224,2.112 -0.40001,0.57601 -0.60001,0.92001 -0.6,1.032 -1e-5,0.096 0.11199,0.14401 0.336,0.144 0.31999,10e-6 0.79999,0.20001 1.44,0.6 0.65599,0.38401 1.07999,0.73601 1.272,1.056 0.38399,0.62401 0.57599,1.54401 0.576,2.76 -10e-6,1.90401 -0.53601,3.512 -1.608,4.824 -1.05601,1.312 -2.05601,1.968 -3,1.968 -0.16,0 -0.368,-0.048 -0.624,-0.144 -0.256,-0.096 -0.48,-0.144 -0.672,-0.144 m 3.096,-16.584 c -0.24001,-0.25598 -0.82401,-0.38398 -1.752,-0.384 -0.576,2e-5 -1.104,0.04 -1.584,0.12 -1.184,0.20802 -1.848,0.36002 -1.992,0.456 -0.16,0.11202 -0.24,0.39202 -0.24,0.84 l 0,0.48 c 0,0.97602 0.096,2.12001 0.288,3.432 0.112,0.86401 0.216,1.42401 0.312,1.68 0.096,0.24001 0.256,0.36001 0.48,0.36 0.352,10e-6 1.04,-0.59999 2.064,-1.8 1.03999,-1.19999 1.75999,-2.23199 2.16,-3.096 0.39999,-0.89598 0.59999,-1.40798 0.6,-1.536 -1e-5,-0.11198 -0.11201,-0.29598 -0.336,-0.552 m 1.536,10.416 c -1e-5,-2.09599 -0.77601,-3.14399 -2.328,-3.144 -0.40001,10e-6 -0.808,0.064 -1.224,0.192 -0.4,0.11201 -0.856,0.28801 -1.368,0.528 -0.496,0.22401 -0.84,0.36801 -1.032,0.432 -0.16,0.064 -0.272,0.16001 -0.336,0.288 -0.048,0.12801 -0.072,0.40801 -0.072,0.84 0,0.43201 0.024,1.12801 0.072,2.088 0.032,0.57601 0.056,1.032 0.072,1.368 0.032,0.32 0.064,0.64 0.096,0.96 0.048,0.32 0.112,0.552 0.192,0.696 0.08,0.144 0.16,0.288 0.24,0.432 0.096,0.128 0.232,0.216 0.408,0.264 0.176,0.048 0.352,0.088 0.528,0.12 0.192,0.016 0.448,0.032 0.768,0.048 0.08,0 0.184,0.008 0.312,0.024 0.128,0 0.216,0 0.264,0 0.39999,0 0.70399,-0.072 0.912,-0.216 0.20799,-0.144 0.56799,-0.52 1.08,-1.128 0.54399,-0.608 0.91199,-1.144 1.104,-1.608 0.20799,-0.47999 0.31199,-1.20799 0.312,-2.184"
         inkscape:connector-curvature="0" />
      <path
         id="path6579"
         d="m 178.88942,397.99871 c -0.096,-1.02398 -0.144,-2.15198 -0.144,-3.384 0,-1.23198 0.032,-2.16798 0.096,-2.808 0.064,-0.65598 0.144,-1.07198 0.24,-1.248 0.096,-0.17598 0.232,-0.26398 0.408,-0.264 0.16,2e-5 0.288,0.072 0.384,0.216 0.096,0.16002 0.384,3.86402 0.864,11.112 0.49599,7.24801 0.74399,11.016 0.744,11.304 -1e-5,0.208 -0.048,0.352 -0.144,0.432 -0.096,0.064 -0.25601,0.096 -0.48,0.096 -0.384,0 -0.632,-0.272 -0.744,-0.816 -0.112,-0.56 -0.272,-2.296 -0.48,-5.208 -0.256,-3.51999 -0.504,-6.66399 -0.744,-9.432"
         inkscape:connector-curvature="0" />
      <path
         id="path6581"
         d="m 185.41329,405.34271 c 0,-2.99199 0.224,-4.48799 0.672,-4.488 0.08,10e-6 0.16,0.016 0.24,0.048 0.096,0.032 0.208,0.15201 0.336,0.36 0.128,0.19201 0.192,0.46401 0.192,0.816 0,0.16001 -0.016,0.43201 -0.048,0.816 -0.032,0.36801 -0.048,0.78401 -0.048,1.248 0,1.29601 0.072,2.87201 0.216,4.728 0.144,1.856 0.296,3.072 0.456,3.648 0.16,0.624 0.432,0.936 0.816,0.936 0.368,0 0.928,-0.328 1.68,-0.984 0.928,-0.816 1.816,-2.088 2.664,-3.816 0.86399,-1.72799 1.46399,-3.45599 1.8,-5.184 0.31999,-1.69599 0.58399,-2.59999 0.792,-2.712 0.15999,-0.11199 0.32799,-0.16799 0.504,-0.168 0.38399,10e-6 0.57599,0.22401 0.576,0.672 -1e-5,0.22401 -0.12001,1.16001 -0.36,2.808 -0.22401,1.64801 -0.33601,2.83201 -0.336,3.552 -1e-5,1.00801 0.19999,2.264 0.6,3.768 0.41599,1.488 0.62399,2.336 0.624,2.544 -1e-5,0.16 -0.064,0.288 -0.192,0.384 -0.12801,0.096 -0.24001,0.152 -0.336,0.168 -0.08,0.032 -0.14401,0.048 -0.192,0.048 -0.28801,0 -0.57601,-0.408 -0.864,-1.224 -0.27201,-0.816 -0.52001,-1.632 -0.744,-2.448 -0.20801,-0.816 -0.39201,-1.224 -0.552,-1.224 -0.032,0 -0.064,0.008 -0.096,0.024 -0.032,0.016 -0.072,0.048 -0.12,0.096 -0.032,0.032 -0.064,0.072 -0.096,0.12 -0.032,0.048 -0.08,0.112 -0.144,0.192 -0.048,0.08 -0.096,0.152 -0.144,0.216 -0.032,0.064 -0.088,0.16 -0.168,0.288 -0.08,0.128 -0.144,0.232 -0.192,0.312 -0.704,1.104 -1.488,2.024 -2.352,2.76 -0.848,0.736 -1.568,1.104 -2.16,1.104 -0.672,0 -1.176,-0.152 -1.512,-0.456 -0.336,-0.288 -0.608,-0.816 -0.816,-1.584 -0.192,-0.768 -0.368,-1.984 -0.528,-3.648 -0.112,-1.05599 -0.168,-2.29599 -0.168,-3.72"
         inkscape:connector-curvature="0" />
      <path
         id="path6583"
         d="m 211.75254,408.63071 c 0.08,10e-6 0.11999,0.064 0.12,0.192 -10e-6,0.28801 -0.21601,0.752 -0.648,1.392 -0.41601,0.64 -0.86401,1.168 -1.344,1.584 -1.68001,1.488 -3.36,2.232 -5.04,2.232 -0.64,0 -1.28,-0.144 -1.92,-0.432 -0.624,-0.304 -1.208,-0.728 -1.752,-1.272 -0.544,-0.544 -0.984,-1.272 -1.32,-2.184 -0.336,-0.91199 -0.504,-1.92799 -0.504,-3.048 0,-0.68799 0.08,-1.27199 0.24,-1.752 0.32,-0.97599 1,-2.00799 2.04,-3.096 1.056,-1.08799 2.048,-1.63199 2.976,-1.632 0.256,10e-6 0.64,0.024 1.152,0.072 0.768,0.064 1.304,0.14401 1.608,0.24 0.31999,0.096 0.67999,0.29601 1.08,0.6 0.51199,0.38401 0.95199,0.88001 1.32,1.488 0.38399,0.59201 0.57599,1.08801 0.576,1.488 -1e-5,0.51201 -0.20001,0.90401 -0.6,1.176 -0.40001,0.25601 -1.17601,0.51201 -2.328,0.768 -1.488,0.33601 -2.96,0.54401 -4.416,0.624 l -2.232,0.12 0,0.96 c 0,1.184 0.552,2.304 1.656,3.36 0.832,0.8 1.696,1.2 2.592,1.2 0.688,0 1.416,-0.208 2.184,-0.624 0.78399,-0.432 1.44799,-0.904 1.992,-1.416 0.54399,-0.512 1.06399,-0.976 1.56,-1.392 0.49599,-0.43199 0.83199,-0.64799 1.008,-0.648 m -3.864,-5.856 c -0.496,-0.44799 -0.872,-0.72799 -1.128,-0.84 -0.24,-0.12799 -0.56,-0.19199 -0.96,-0.192 -0.8,1e-5 -1.4,0.08 -1.8,0.24 -0.384,0.14401 -0.776,0.44801 -1.176,0.912 -1.216,1.39201 -1.824,2.32001 -1.824,2.784 0,0.20801 0.192,0.31201 0.576,0.312 1.456,1e-5 3.52,-0.30399 6.192,-0.912 0.79999,-0.19199 1.19999,-0.52799 1.2,-1.008 -1e-5,-0.22399 -0.36001,-0.65599 -1.08,-1.296"
         inkscape:connector-curvature="0" />
    </g>
    <g
       id="text5928"
       style="font-size:24px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;text-align:start;line-height:125%;letter-spacing:0px;word-spacing:0px;text-anchor:start;fill:#ff00ff;fill-opacity:1;stroke:none;font-family:Purisa;-inkscape-font-specification:Purisa">
      <path
         id="path6586"
         d="m 484.11656,416.20907 c -0.208,-10e-6 -0.376,-0.14401 -0.504,-0.432 -0.112,-0.28801 -0.208,-0.912 -0.288,-1.872 -0.08,-0.96 -0.136,-2.248 -0.168,-3.864 -0.016,-1.632 -0.024,-3.88 -0.024,-6.744 0,-4.91199 0.096,-7.48799 0.288,-7.728 0.224,-0.30398 0.52,-0.45598 0.888,-0.456 0.208,2e-5 0.408,0.20802 0.6,0.624 0.20799,0.41601 0.47199,1.17601 0.792,2.28 0.47999,1.74401 1.03199,3.32001 1.656,4.728 0.63999,1.39201 1.09599,2.08801 1.368,2.088 0.27199,10e-6 0.84799,-0.74399 1.728,-2.232 0.87999,-1.50399 1.88799,-3.46399 3.024,-5.88 0.20799,-0.44799 0.47999,-0.80799 0.816,-1.08 0.33599,-0.27198 0.66398,-0.40798 0.984,-0.408 0.22398,2e-5 0.39998,0.064 0.528,0.192 0.35198,0.32001 0.58398,1.04001 0.696,2.16 0.11198,1.10401 0.18398,3.44001 0.216,7.008 0.016,2.16 0.064,3.92 0.144,5.28 0.08,1.36 0.15998,2.224 0.24,2.592 0.096,0.352 0.17598,0.648 0.24,0.888 0.064,0.24 0.096,0.472 0.096,0.696 -2e-5,0.496 -0.22402,0.744 -0.672,0.744 -0.25602,0 -0.50402,-0.08 -0.744,-0.24 -0.24002,-0.16 -0.40802,-0.368 -0.504,-0.624 -0.096,-0.256 -0.19202,-1.672 -0.288,-4.248 -0.096,-2.576 -0.19202,-5.07199 -0.288,-7.488 -0.096,-2.41599 -0.20001,-3.62399 -0.312,-3.624 -0.14401,10e-6 -0.45601,0.53601 -0.936,1.608 -0.57601,1.31201 -1.32001,2.76001 -2.232,4.344 -0.33601,0.59201 -0.84801,1.128 -1.536,1.608 -0.67201,0.464 -1.26401,0.696 -1.776,0.696 -0.12801,0 -0.36001,-0.2 -0.696,-0.6 -0.33601,-0.416 -0.67201,-0.91199 -1.008,-1.488 l -1.224,-2.088 0,6.192 c -0.016,3.04 -0.096,5.024 -0.24,5.952 -0.12801,0.94399 -0.416,1.41599 -0.864,1.416"
         inkscape:connector-curvature="0" />
      <path
         id="path6588"
         d="m 507.55406,402.55307 c -0.73601,1e-5 -1.52001,0.15201 -2.352,0.456 -0.81601,0.30401 -1.54401,0.61601 -2.184,0.936 -0.64001,0.30401 -1.104,0.45601 -1.392,0.456 -0.192,10e-6 -0.288,-0.08 -0.288,-0.24 0,-0.22399 0.048,-0.41599 0.144,-0.576 0.096,-0.15999 0.272,-0.31199 0.528,-0.456 0.25599,-0.14399 0.49599,-0.26399 0.72,-0.36 0.23999,-0.096 0.61599,-0.23199 1.128,-0.408 0.51199,-0.19199 0.95199,-0.36799 1.32,-0.528 0.86399,-0.33599 1.59199,-0.50399 2.184,-0.504 1.05599,10e-6 1.87999,0.57601 2.472,1.728 0.28799,0.56001 0.45599,1.08001 0.504,1.56 0.048,0.46401 0.088,1.784 0.12,3.96 0.016,1.216 0.04,2.24 0.072,3.072 0.032,0.816 0.064,1.336 0.096,1.56 l 0.048,0.312 c -10e-6,0.224 -0.10401,0.464 -0.312,0.72 -0.19201,0.256 -0.33601,0.384 -0.432,0.384 -0.32001,0 -0.56801,-0.504 -0.744,-1.512 -0.17601,-1.024 -0.27201,-1.536 -0.288,-1.536 -0.048,0 -0.12001,0.088 -0.216,0.264 -0.32001,0.528 -0.96801,1.112 -1.944,1.752 -0.96001,0.624 -1.76801,0.936 -2.424,0.936 -0.40001,0 -0.87201,-0.072 -1.416,-0.216 -0.52801,-0.16 -0.912,-0.328 -1.152,-0.504 -0.176,-0.144 -0.328,-0.432 -0.456,-0.864 -0.112,-0.432 -0.168,-0.872 -0.168,-1.32 0,-0.672 0.176,-1.248 0.528,-1.728 0.368,-0.496 1.01599,-1 1.944,-1.512 1.00799,-0.592 1.98399,-0.888 2.928,-0.888 0.38399,0 0.70399,0.064 0.96,0.192 0.25599,0.128 0.44799,0.264 0.576,0.408 0.12799,0.128 0.23199,0.192 0.312,0.192 0.064,0 0.21599,0.088 0.456,0.264 0.23999,0.16 0.36799,0.24 0.384,0.24 0.064,0 0.096,-0.176 0.096,-0.528 -10e-6,-2.144 -0.15201,-3.63199 -0.456,-4.464 -0.28801,-0.83199 -0.72001,-1.24799 -1.296,-1.248 m 1.08,7.44 c -10e-6,-0.064 -0.024,-0.136 -0.072,-0.216 -0.032,-0.096 -0.11201,-0.2 -0.24,-0.312 -0.11201,-0.128 -0.26401,-0.24 -0.456,-0.336 -0.17601,-0.112 -0.42401,-0.2 -0.744,-0.264 -0.32001,-0.08 -0.68001,-0.12 -1.08,-0.12 -0.68801,0 -1.29601,0.12 -1.824,0.36 -0.51201,0.24 -0.89601,0.544 -1.152,0.912 -0.25601,0.368 -0.44801,0.712 -0.576,1.032 -0.11201,0.304 -0.16801,0.576 -0.168,0.816 -1e-5,0.4 0.032,0.672 0.096,0.816 0.08,0.144 0.26399,0.296 0.552,0.456 0.35199,0.176 0.67199,0.264 0.96,0.264 0.54399,0 1.21599,-0.192 2.016,-0.576 0.81599,-0.4 1.22399,-0.688 1.224,-0.864 -10e-6,-0.128 0.23999,-0.432 0.72,-0.912 0.49599,-0.496 0.74399,-0.848 0.744,-1.056"
         inkscape:connector-curvature="0" />
      <path
         id="path6590"
         d="m 524.51343,419.04107 c 0.14399,-10e-6 0.27199,-0.016 0.384,-0.048 0.12799,-0.016 0.23199,-0.048 0.312,-0.096 0.08,-0.048 0.15199,-0.096 0.216,-0.144 0.064,-0.048 0.11199,-0.11201 0.144,-0.192 0.032,-0.064 0.056,-0.12801 0.072,-0.192 0.032,-0.048 0.048,-0.11201 0.048,-0.192 -10e-6,-0.064 -10e-6,-0.12001 0,-0.168 -10e-6,-0.032 -10e-6,-0.072 0,-0.12 l 0,-0.072 c -10e-6,-1.53601 -0.10401,-2.992 -0.312,-4.368 l -0.336,-2.088 c -0.11201,-1.632 -0.22401,-2.448 -0.336,-2.448 -0.064,0 -0.18401,0.144 -0.36,0.432 -0.40001,0.592 -1.04801,1.256 -1.944,1.992 -0.89601,0.736 -1.64001,1.216 -2.232,1.44 -0.688,0.272 -1.448,0.408 -2.28,0.408 -0.512,0 -0.92,-0.064 -1.224,-0.192 -0.288,-0.128 -0.672,-0.4 -1.152,-0.816 -0.464,-0.416 -0.792,-0.784 -0.984,-1.104 -0.192,-0.32 -0.344,-0.776 -0.456,-1.368 -0.112,-0.592 -0.168,-1.096 -0.168,-1.512 0,-0.304 0.024,-0.528 0.072,-0.672 0.112,-0.432 0.408,-1.104 0.888,-2.016 0.48,-0.91199 0.92,-1.62399 1.32,-2.136 0.336,-0.44799 0.96,-0.96799 1.872,-1.56 0.928,-0.60799 1.744,-1.02399 2.448,-1.248 0.75199,-0.23999 1.59199,-0.35999 2.52,-0.36 1.18399,10e-6 2.16799,0.20801 2.952,0.624 0.78399,0.40001 1.17599,1.02401 1.176,1.872 -10e-6,0.48001 -0.12001,1.07201 -0.36,1.776 -0.22401,0.70401 -0.33601,1.32 -0.336,1.848 -1e-5,0.576 0.18399,3.224 0.552,7.944 l 0.36,4.968 -0.84,0.672 c -0.44801,0.36799 -0.90401,0.55199 -1.368,0.552 -0.84801,-10e-6 -1.88001,-0.21601 -3.096,-0.648 -1.21601,-0.41601 -2.264,-0.90401 -3.144,-1.464 -0.88,-0.54401 -1.32,-0.99201 -1.32,-1.344 0,-0.41601 0.216,-0.92801 0.648,-1.536 0.448,-0.608 0.824,-0.912 1.128,-0.912 0.352,0 0.528,0.12 0.528,0.36 0,0.144 -0.072,0.36 -0.216,0.648 -0.144,0.28799 -0.216,0.56799 -0.216,0.84 0,0.44799 0.296,0.83999 0.888,1.176 0.59199,0.33599 1.09599,0.50399 1.512,0.504 0.23999,-1e-5 0.63199,0.15999 1.176,0.48 0.55999,0.31999 1.04799,0.47999 1.464,0.48 m -9.12,-10.896 c 0,0.928 0.24,1.776 0.72,2.544 0.48,0.768 1.08,1.152 1.8,1.152 0.976,0 2.024,-0.44 3.144,-1.32 1.13599,-0.896 2.05599,-2.008 2.76,-3.336 0.38399,-0.752 0.71199,-1.608 0.984,-2.568 0.28799,-0.97599 0.43199,-1.74399 0.432,-2.304 -10e-6,-0.31999 -0.056,-0.51199 -0.168,-0.576 -0.36801,-0.19199 -0.95201,-0.28799 -1.752,-0.288 -0.73601,10e-6 -1.36801,0.08 -1.896,0.24 -1.392,0.40001 -2.744,1.33601 -4.056,2.808 -1.312,1.472 -1.968,2.688 -1.968,3.648"
         inkscape:connector-curvature="0" />
      <path
         id="path6592"
         d="m 542.73243,409.34507 c 0.08,0 0.11999,0.064 0.12,0.192 -10e-6,0.288 -0.21601,0.752 -0.648,1.392 -0.41601,0.64 -0.86401,1.168 -1.344,1.584 -1.68001,1.488 -3.36001,2.232 -5.04,2.232 -0.64,0 -1.28,-0.144 -1.92,-0.432 -0.624,-0.304 -1.208,-0.728 -1.752,-1.272 -0.544,-0.544 -0.984,-1.272 -1.32,-2.184 -0.336,-0.912 -0.504,-1.928 -0.504,-3.048 0,-0.688 0.08,-1.272 0.24,-1.752 0.32,-0.97599 1,-2.00799 2.04,-3.096 1.056,-1.08799 2.048,-1.63199 2.976,-1.632 0.256,10e-6 0.64,0.024 1.152,0.072 0.76799,0.064 1.30399,0.14401 1.608,0.24 0.31999,0.096 0.67999,0.29601 1.08,0.6 0.51199,0.38401 0.95199,0.88001 1.32,1.488 0.38399,0.59201 0.57599,1.08801 0.576,1.488 -10e-6,0.512 -0.20001,0.904 -0.6,1.176 -0.40001,0.256 -1.17601,0.512 -2.328,0.768 -1.488,0.336 -2.96,0.544 -4.416,0.624 l -2.232,0.12 0,0.96 c 0,1.184 0.552,2.304 1.656,3.36 0.832,0.8 1.696,1.2 2.592,1.2 0.688,0 1.416,-0.208 2.184,-0.624 0.78399,-0.432 1.44799,-0.904 1.992,-1.416 0.54399,-0.512 1.06399,-0.976 1.56,-1.392 0.49599,-0.432 0.83199,-0.648 1.008,-0.648 m -3.864,-5.856 c -0.49601,-0.44799 -0.87201,-0.72799 -1.128,-0.84 -0.24001,-0.12799 -0.56,-0.19199 -0.96,-0.192 -0.8,1e-5 -1.4,0.08 -1.8,0.24 -0.384,0.14401 -0.776,0.44801 -1.176,0.912 -1.216,1.39201 -1.824,2.32 -1.824,2.784 0,0.208 0.192,0.312 0.576,0.312 1.456,0 3.52,-0.304 6.192,-0.912 0.79999,-0.192 1.19999,-0.52799 1.2,-1.008 -10e-6,-0.22399 -0.36001,-0.65599 -1.08,-1.296"
         inkscape:connector-curvature="0" />
      <path
         id="path6594"
         d="m 546.93693,401.52107 c 0,-0.54399 0.16,-0.81599 0.48,-0.816 0.208,1e-5 0.36,0.24001 0.456,0.72 0.096,0.46401 0.272,1.85601 0.528,4.176 0.32,2.592 0.488,3.904 0.504,3.936 0.016,0.016 0.08,-0.136 0.192,-0.456 0.128,-0.336 0.296,-0.832 0.504,-1.488 0.32,-1.056 0.592,-1.816 0.816,-2.28 0.224,-0.47999 0.624,-1.13599 1.2,-1.968 1.16799,-1.61599 2.07199,-2.42399 2.712,-2.424 0.41599,1e-5 0.80799,0.28001 1.176,0.84 0.49599,0.73601 0.79999,1.46401 0.912,2.184 0.11199,0.72001 0.19199,2.424 0.24,5.112 0.032,1.728 0.048,2.752 0.048,3.072 -10e-6,0.8 -0.032,1.384 -0.096,1.752 -0.048,0.352 -0.12801,0.568 -0.24,0.648 -0.096,0.096 -0.27201,0.152 -0.528,0.168 -0.14401,0 -0.24001,-0.064 -0.288,-0.192 -0.048,-0.112 -0.072,-0.384 -0.072,-0.816 -10e-6,-0.24 0.016,-0.752 0.048,-1.536 0.032,-0.8 0.048,-1.472 0.048,-2.016 -10e-6,-1.36 -0.056,-2.688 -0.168,-3.984 -0.096,-1.31199 -0.21601,-2.15199 -0.36,-2.52 -0.08,-0.20799 -0.20801,-0.42399 -0.384,-0.648 -0.17601,-0.22399 -0.34401,-0.33599 -0.504,-0.336 -0.33601,1e-5 -0.87201,0.57601 -1.608,1.728 -0.736,1.136 -1.368,2.336 -1.896,3.6 -0.496,1.152 -0.832,2.04 -1.008,2.664 -0.16,0.608 -0.296,1.44 -0.408,2.496 -0.176,1.632 -0.304,2.44799 -0.384,2.448 -0.128,-10e-6 -0.312,-0.13601 -0.552,-0.408 -0.176,-0.176 -0.296,-0.552 -0.36,-1.128 -0.064,-0.592 -0.152,-1.752 -0.264,-3.48 -0.112,-1.744 -0.264,-3.504 -0.456,-5.28 -0.192,-1.83999 -0.288,-3.09599 -0.288,-3.768"
         inkscape:connector-curvature="0" />
      <path
         id="path6596"
         d="m 564.38831,397.82507 c -1e-5,-0.59199 -0.056,-1.34399 -0.168,-2.256 -0.11201,-0.91198 -0.16801,-1.67198 -0.168,-2.28 -1e-5,-0.30398 0.008,-0.50398 0.024,-0.6 0.048,-0.25598 0.13599,-0.45598 0.264,-0.6 0.14399,-0.15998 0.28799,-0.23998 0.432,-0.24 0.19199,2e-5 0.32799,0.088 0.408,0.264 0.048,0.11202 0.11999,0.70402 0.216,1.776 0.096,1.07202 0.18399,2.12001 0.264,3.144 0.08,1.02401 0.13599,1.55201 0.168,1.584 0.016,0.016 0.04,0.024 0.072,0.024 0.12799,10e-6 0.49599,-0.064 1.104,-0.192 0.62399,-0.14399 1.13599,-0.21599 1.536,-0.216 0.79999,10e-6 1.19999,0.17601 1.2,0.528 -10e-6,0.35201 -0.88001,0.74401 -2.64,1.176 l -1.2,0.288 0.144,4.056 c 0.08,2.384 0.23199,4.616 0.456,6.696 0.22399,2.064 0.33599,3.232 0.336,3.504 -10e-6,0.496 -0.18401,0.744 -0.552,0.744 -0.28801,0 -0.52801,-0.256 -0.72,-0.768 -0.17601,-0.512 -0.26401,-1.176 -0.264,-1.992 -10e-6,-0.592 -0.024,-1.192 -0.072,-1.8 -0.048,-0.624 -0.13601,-1.584 -0.264,-2.88 -0.11201,-1.312 -0.22401,-2.65599 -0.336,-4.032 -0.048,-0.73599 -0.088,-1.30399 -0.12,-1.704 -0.016,-0.39999 -0.04,-0.69599 -0.072,-0.888 -0.032,-0.19199 -0.056,-0.30399 -0.072,-0.336 -0.016,-0.048 -0.048,-0.072 -0.096,-0.072 -0.25601,1e-5 -0.87201,0.088 -1.848,0.264 -0.976,0.17601 -1.584,0.26401 -1.824,0.264 -0.464,10e-6 -0.696,-0.19199 -0.696,-0.576 0,-0.27199 0.288,-0.50399 0.864,-0.696 0.592,-0.19199 1.256,-0.35999 1.992,-0.504 0.73599,-0.15999 1.19199,-0.29599 1.368,-0.408 0.17599,-0.12799 0.26399,-0.55199 0.264,-1.272"
         inkscape:connector-curvature="0" />
      <path
         id="path6598"
         d="m 579.92906,402.55307 c -0.73601,1e-5 -1.52001,0.15201 -2.352,0.456 -0.81601,0.30401 -1.54401,0.61601 -2.184,0.936 -0.64001,0.30401 -1.104,0.45601 -1.392,0.456 -0.192,10e-6 -0.288,-0.08 -0.288,-0.24 0,-0.22399 0.048,-0.41599 0.144,-0.576 0.096,-0.15999 0.272,-0.31199 0.528,-0.456 0.25599,-0.14399 0.49599,-0.26399 0.72,-0.36 0.23999,-0.096 0.61599,-0.23199 1.128,-0.408 0.51199,-0.19199 0.95199,-0.36799 1.32,-0.528 0.86399,-0.33599 1.59199,-0.50399 2.184,-0.504 1.05599,10e-6 1.87999,0.57601 2.472,1.728 0.28799,0.56001 0.45599,1.08001 0.504,1.56 0.048,0.46401 0.088,1.784 0.12,3.96 0.016,1.216 0.04,2.24 0.072,3.072 0.032,0.816 0.064,1.336 0.096,1.56 l 0.048,0.312 c -1e-5,0.224 -0.10401,0.464 -0.312,0.72 -0.19201,0.256 -0.33601,0.384 -0.432,0.384 -0.32001,0 -0.56801,-0.504 -0.744,-1.512 -0.17601,-1.024 -0.27201,-1.536 -0.288,-1.536 -0.048,0 -0.12001,0.088 -0.216,0.264 -0.32001,0.528 -0.96801,1.112 -1.944,1.752 -0.96001,0.624 -1.76801,0.936 -2.424,0.936 -0.40001,0 -0.87201,-0.072 -1.416,-0.216 -0.52801,-0.16 -0.912,-0.328 -1.152,-0.504 -0.176,-0.144 -0.328,-0.432 -0.456,-0.864 -0.112,-0.432 -0.168,-0.872 -0.168,-1.32 0,-0.672 0.176,-1.248 0.528,-1.728 0.368,-0.496 1.01599,-1 1.944,-1.512 1.00799,-0.592 1.98399,-0.888 2.928,-0.888 0.38399,0 0.70399,0.064 0.96,0.192 0.25599,0.128 0.44799,0.264 0.576,0.408 0.12799,0.128 0.23199,0.192 0.312,0.192 0.064,0 0.21599,0.088 0.456,0.264 0.23999,0.16 0.36799,0.24 0.384,0.24 0.064,0 0.096,-0.176 0.096,-0.528 -10e-6,-2.144 -0.15201,-3.63199 -0.456,-4.464 -0.28801,-0.83199 -0.72001,-1.24799 -1.296,-1.248 m 1.08,7.44 c -10e-6,-0.064 -0.024,-0.136 -0.072,-0.216 -0.032,-0.096 -0.11201,-0.2 -0.24,-0.312 -0.11201,-0.128 -0.26401,-0.24 -0.456,-0.336 -0.17601,-0.112 -0.42401,-0.2 -0.744,-0.264 -0.32001,-0.08 -0.68001,-0.12 -1.08,-0.12 -0.68801,0 -1.29601,0.12 -1.824,0.36 -0.51201,0.24 -0.89601,0.544 -1.152,0.912 -0.25601,0.368 -0.44801,0.712 -0.576,1.032 -0.11201,0.304 -0.16801,0.576 -0.168,0.816 -10e-6,0.4 0.032,0.672 0.096,0.816 0.08,0.144 0.26399,0.296 0.552,0.456 0.35199,0.176 0.67199,0.264 0.96,0.264 0.54399,0 1.21599,-0.192 2.016,-0.576 0.81599,-0.4 1.22399,-0.688 1.224,-0.864 -1e-5,-0.128 0.23999,-0.432 0.72,-0.912 0.49599,-0.496 0.74399,-0.848 0.744,-1.056"
         inkscape:connector-curvature="0" />
    </g>
    <rect
       style="fill:none;stroke:#ff0000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none"
       id="red-rect"
       width="377.85715"
       height="300"
       x="52.857143"
       y="55.933609"
       inkscape:label="#rect5940" />
    <rect
       y="67.045288"
       x="276.10086"
       height="300"
       width="377.85715"
       id="green-rect"
       style="fill:none;stroke:#008000;stroke-width:2;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       inkscape:label="#rect5942" />
    <rect
       style="fill:none;stroke:#ff00ff;stroke-width:2;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       id="magenta-rect"
       width="377.85715"
       height="300"
       x="286.20239"
       y="220.58847"
       inkscape:label="#rect5944" />
    <rect
       y="210.48694"
       x="32.654102"
       height="300"
       width="377.85715"
       id="blue-rect"
       style="fill:none;stroke:#0000ff;stroke-width:2;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       inkscape:label="#rect5946" />
    <rect
       style="fill:none;stroke:#000000;stroke-width:2;stroke-miterlimit:4;stroke-dasharray:none"
       id="black-rect"
       width="253.31075"
       height="201.04854"
       x="224.84317"
       y="182.19505"
       inkscape:label="#rect5948" />
    <a
       xlink:href="#red-frame"
       id="a3092">
      <path
         d="m 344.10713,254.59433 c 0,11.4895 -9.31408,20.80357 -20.80357,20.80357 -11.4895,0 -20.80357,-9.31407 -20.80357,-20.80357 0,-11.4895 9.31407,-20.80357 20.80357,-20.80357 11.48949,0 20.80357,9.31407 20.80357,20.80357 z"
         sodipodi:ry="20.803572"
         sodipodi:rx="20.803572"
         sodipodi:cy="254.59433"
         sodipodi:cx="323.30356"
         id="path3798"
         style="fill:#ff0000;fill-opacity:1;stroke:none"
         sodipodi:type="arc" />
    </a>
    <a
       id="a3173"
       xlink:href="#green-frame">
      <path
         transform="translate(56.607143,0)"
         sodipodi:type="arc"
         style="fill:#008000;fill-opacity:1;stroke:none"
         id="path3800"
         sodipodi:cx="323.30356"
         sodipodi:cy="254.59433"
         sodipodi:rx="20.803572"
         sodipodi:ry="20.803572"
         d="m 344.10713,254.59433 c 0,11.4895 -9.31408,20.80357 -20.80357,20.80357 -11.4895,0 -20.80357,-9.31407 -20.80357,-20.80357 0,-11.4895 9.31407,-20.80357 20.80357,-20.80357 11.48949,0 20.80357,9.31407 20.80357,20.80357 z" />
    </a>
    <a
       id="a3179"
       xlink:href="#blue-frame">
      <path
         transform="translate(0,56.25)"
         sodipodi:type="arc"
         style="fill:#0000ff;fill-opacity:1;stroke:none"
         id="path3802"
         sodipodi:cx="323.30356"
         sodipodi:cy="254.59433"
         sodipodi:rx="20.803572"
         sodipodi:ry="20.803572"
         d="m 344.10713,254.59433 c 0,11.4895 -9.31408,20.80357 -20.80357,20.80357 -11.4895,0 -20.80357,-9.31407 -20.80357,-20.80357 0,-11.4895 9.31407,-20.80357 20.80357,-20.80357 11.48949,0 20.80357,9.31407 20.80357,20.80357 z" />
    </a>
    <a
       id="a3176"
       xlink:href="#magenta-frame">
      <path
         d="m 344.10713,254.59433 c 0,11.4895 -9.31408,20.80357 -20.80357,20.80357 -11.4895,0 -20.80357,-9.31407 -20.80357,-20.80357 0,-11.4895 9.31407,-20.80357 20.80357,-20.80357 11.48949,0 20.80357,9.31407 20.80357,20.80357 z"
         sodipodi:ry="20.803572"
         sodipodi:rx="20.803572"
         sodipodi:cy="254.59433"
         sodipodi:cx="323.30356"
         id="path3804"
         style="fill:#ff00ff;fill-opacity:1;stroke:none"
         sodipodi:type="arc"
         transform="translate(56.607143,56.25)" />
    </a>
  </g>
  <script
     ns1:version="13.11-30180946"
     id="sozi-script">/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * Create or augment a namespace.
 *
 * &lt;p&gt;A typical use of this function is:&lt;/p&gt;
 *
 * &lt;pre&gt;
 * namespace(this, &quot;a.b.c&quot;, function (exports, globals) {
 *     exports.foo = function (x) {
 *         ...
 *     };
 * });
 * &lt;/pre&gt;
 *
 * &lt;p&gt;where &lt;code&gt;this&lt;/code&gt; is the global object.&lt;/p&gt;
 *
 * &lt;p&gt;In this example, function &lt;code&gt;foo&lt;/code&gt; is exported and can be
 * called as &lt;code&gt;a.b.c.foo(someValue)&lt;/code&gt;.&lt;/p&gt;
 *
 * @memberOf _global_
 * @param globals The global object
 * @param {String} path The dot-separated path to the namespace
 * @param {Function} body A function to execute in the context of the namespace
 */
function namespace(globals, path, body) {
    &quot;use strict&quot;;
    
    // Start name lookup in the global object
	var current = globals;
	
	// For each name in the given path
	path.split(&quot;.&quot;).forEach(function (name) {
	    // If the current path element does not exist
	    // in the current namespace, create a new sub-namespace
		if (typeof current[name] === &quot;undefined&quot;) {
			current[name] = {};
		}
		
		// Move to the namespace for the current path element
		current = current[name];
	});
	
	// Execute the given function in the last namespace
	if (body) {
	    body(current, globals);
	}
	
	return current;
}


/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.events
 * @namespace A simple event system for Sozi.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.events&quot;, function (exports) {
    /** @lends sozi.events */

    &quot;use strict&quot;;
    
    /**
     * A registry of callback functions for each event type.
     *
     * &lt;p&gt;Call {@link sozi.events.listen} to add a new listener.&lt;/p&gt;
     */
    var listenerRegistry = {};

    /**
     * Adds a listener for a given event type.
     *
     * @memberOf sozi.events
     * @name listen
     * @function
     * @param {String} key The identifier of the event type to listen
     * @param {Function} handler The function to call when a corresponding event is fired
     */
    exports.listen = function (key, handler) {
        if (!listenerRegistry.hasOwnProperty(key)) {
            listenerRegistry[key] = [];
        }
        listenerRegistry[key].push(handler);
    };
    
    /**
     * Fire an event of a given type.
     *
     * &lt;p&gt;All event handlers added for the given event type are
     * executed.&lt;/p&gt;
     *
     * &lt;p&gt;Additional arguments provided to this function are passed
     * to the event handlers.&lt;/p&gt;
     *
     * @memberOf sozi.events
     * @name fire
     * @function
     * @param {String} key The identifier of the event type to fire
     */
    exports.fire = function (key) {
        var args = Array.prototype.slice.call(arguments, 1);
        if (listenerRegistry.hasOwnProperty(key)) {
            listenerRegistry[key].forEach(function (listener) {
                listener.apply(null, args);
            });
        }
    };
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.proto
 * @namespace Helpers for prototype inheritance.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.proto&quot;, function (exports) {
    &quot;use strict&quot;;
    
    exports.Object = {
        installConstructors: function () {
            function InstanceConstructor() {}
            InstanceConstructor.prototype = this;
            
            this.instance = function () {
                var result = new InstanceConstructor();
                result.construct.apply(result, arguments);
                return result;
            };
            
            this.subtype = function (anObject) {
                var result = new InstanceConstructor();
                result.augment(anObject);
                result.installConstructors();
                return result;
            };
        },
        
        construct: function () {},
        
        augment: function (anObject) {
            for (var attr in anObject) {
                if (anObject.hasOwnProperty(attr)) {
                    this[attr] = anObject[attr];
                }
            }
            return this;
        },
        
        bind: function (aFunction) {
            var self = this;
            return function () {
                return aFunction.apply(self, arguments);
            }
        }
    };
    
    // Bootstrap the root object
    exports.Object.installConstructors();
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.actions
 * @namespace Callback functions for DOM event handlers
 * @depend namespace.js
 */
namespace(this, &quot;sozi.actions&quot;, function (exports, window) {
    /** @lends sozi.actions */
    
    &quot;use strict&quot;;
    
    // Module aliases
    var player = namespace(window, &quot;sozi.player&quot;);
    var display = namespace(window, &quot;sozi.display&quot;);
    
    // The global document object
    var document = window.document;
    
    // Constants: mouse button numbers
    var DRAG_BUTTON = 0;    // Left button
    var TOC_BUTTON = 1;     // Middle button
    
    // Constants: increments for zooming and rotating,
    // threshold for dragging
    var SCALE_FACTOR = 1.05;
    var ROTATE_STEP = 5;
    var DRAG_THRESHOLD_PX = 5;
    
    /**
     * The status of the current drag operation.
     *
     * @type Boolean
     */
    var mouseDragged = false;
    
    /**
     * The X coordinate of the mouse on the latest &quot;down&quot; or &quot;drag&quot; event.
     *
     * @type Number
     */
    var mouseLastX = 0;

    /**
     * The Y coordinate of the mouse on the latest &quot;down&quot; or &quot;drag&quot; event.
     *
     * @type Number
     */
    var mouseLastY = 0;
    
    /**
     * Zooms the display in the given direction.
     *
     * &lt;p&gt;Only the sign of &lt;code&gt;direction&lt;/code&gt; is used:&lt;/p&gt;
     * &lt;ul&gt;
     *  &lt;li&gt;zoom in when &lt;code&gt;direction &gt; 0&lt;/code&gt;&lt;/li&gt;
     *  &lt;li&gt;zoom out when &lt;code&gt;direction &lt;= 0&lt;/code&gt;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * &lt;p&gt;The scaling is centered around point (&lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt;).&lt;/p&gt;
     *
     * @param {Number} direction The direction of the scaling operation
     * @param {Number} x The X coordinate of the scaling center
     * @param {Number} y The Y coordinate of the scaling center
     */
    function zoom(direction, x, y) {
        player.stop();
        display.viewPorts[&quot;player&quot;].zoom(direction &gt; 0 ? SCALE_FACTOR : 1 / SCALE_FACTOR, x, y);
    }
    
    /**
     * Rotate the display in the given direction.
     *
     * &lt;p&gt;Only the sign of &lt;code&gt;direction&lt;/code&gt; is used:&lt;/p&gt;
     * &lt;ul&gt;
     *  &lt;li&gt;rotate anticlockwise when direction &gt; 0&lt;/li&gt;
     *  &lt;li&gt;rotate clockwise when direction &lt;= 0&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @param {Number} direction The direction of the rotation
     */
    function rotate(direction) {
        player.stop();
        display.viewPorts[&quot;player&quot;].rotate(direction &gt; 0 ? ROTATE_STEP : -ROTATE_STEP);
    }
    
    /**
     * Show/hide the frame list.
     *
     * &lt;p&gt;The presentation stops when the frame list is showed,
     * and restarts when the frame list is hidden.&lt;/p&gt;
     */
    function toggleFrameList() {
        if (sozi.framelist.isVisible()) {
            sozi.framelist.hide();
            player.restart();
        } else {
            player.stop();
            sozi.framelist.show();
        }
    }

    function isPlayerEvent(evt) {
        return display.viewPorts[&quot;player&quot;].contains(evt.clientX, evt.clientY);
    }
    
    /**
     * Event handler: mouse down.
     *
     * &lt;p&gt;When the left button is pressed, we register the current coordinates
     * in case the mouse will be dragged. Handler {@link sozi.actions-onMouseDrag} is set until
     * the button is released ({@link sozi.actions-onMouseUp}).&lt;/p&gt;
     *
     * &lt;p&gt;When the middle button is pressed, the table of contents is shown or hidden.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onMouseDown(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        if (evt.button === DRAG_BUTTON) {
            document.documentElement.addEventListener(&quot;mousemove&quot;, onMouseDrag, false);
            mouseDragged = false;
            mouseLastX = evt.clientX;
            mouseLastY = evt.clientY;
        } else if (evt.button === TOC_BUTTON) {
            toggleFrameList();
        }
        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: mouse move.
     *
     * &lt;p&gt;If the left mouse button is down, then the mouse move is a drag action.
     * This method computes the displacement since the button was pressed or
     * since the last move, and updates the reference coordinates for the next move.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onMouseDrag(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        player.stop();
        
        // The drag action is confirmed when one of the mouse coordinates
        // has moved past the threshold
        if (!mouseDragged &amp;&amp; (Math.abs(evt.clientX - mouseLastX) &gt; DRAG_THRESHOLD_PX ||
                              Math.abs(evt.clientY - mouseLastY) &gt; DRAG_THRESHOLD_PX)) {
            mouseDragged = true;
        }
        
        if (mouseDragged) {
            sozi.events.fire(&quot;sozi.player.cleanup&quot;);
            display.viewPorts[&quot;player&quot;].drag(evt.clientX - mouseLastX, evt.clientY - mouseLastY);
            mouseLastX = evt.clientX;
            mouseLastY = evt.clientY;
        }
        
        evt.stopPropagation();
    }

    /**
     * Event handler: mouse up.
     *
     * &lt;p&gt;Releasing the left button removes the {@link sozi.actions-onMouseDrag} handler.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onMouseUp(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        if (evt.button === DRAG_BUTTON) {
            document.documentElement.removeEventListener(&quot;mousemove&quot;, onMouseDrag, false);
        }
        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: context menu (i.e right click).
     *
     * &lt;p&gt;Right click goes one frame back.&lt;/p&gt;
     *
     * &lt;p&gt;There is no &quot;click&quot; event for the right mouse button and the menu
     * can't be disabled in {@link sozi.actions-onMouseDown}.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onContextMenu(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        player.moveToPrevious();
        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: mouse click.
     *
     * &lt;p&gt;Left-click moves the presentation to the next frame.&lt;/p&gt;
     *
     * &lt;p&gt;No &quot;click&quot; event is generated for the middle button in Firefox.
     * See {@link sozi.actions-onMouseDown} for middle click handling.&lt;/p&gt;
     *
     * &lt;p&gt;Dragging the mouse produces a &quot;click&quot; event when the button is released.
     * If flag {@link sozi.actions-mouseDragged} was set by {@link sozi.actions-onMouseDrag},
     * then the click event is the result of a drag action.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onClick(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        if (!mouseDragged &amp;&amp; evt.button !== TOC_BUTTON) {
            player.moveToNext();
        }
        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: mouse wheel.
     *
     * &lt;p&gt;Rolling the mouse wheel stops the presentation and zooms the current display.&lt;/p&gt;
     *
     * FIXME shift key does not work in Opera
     *
     * @param {Event} evt The DOM event object
     */
    function onWheel(evt) {
        if (!isPlayerEvent(evt)) {
            return;
        }
        
        if (!evt) {
            evt = window.event;
        }

        var delta = 0;
        if (evt.wheelDelta) { // IE and Opera
            delta = evt.wheelDelta;
        }
        else if (evt.detail) { // Mozilla
            delta = -evt.detail;
        }
        
        if (delta !== 0) {
            if (evt.shiftKey) {
                rotate(delta);
            }
            else {
                zoom(delta, evt.clientX, evt.clientY);
            }
        }
        
        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: key press.
     *
     * &lt;p&gt;Keyboard handling is split into two methods:
     * {@link sozi.actions-onKeyPress} and {@link sozi.actions-onKeyDown}
     * in order to get the same behavior across browsers.&lt;/p&gt;
     *
     * &lt;p&gt;This method handles character keys &quot;+&quot;, &quot;-&quot;, &quot;=&quot;, &quot;F&quot; and &quot;T&quot;.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onKeyPress(evt) {
        // Keys with modifiers are ignored
        if (evt.altKey || evt.ctrlKey || evt.metaKey) {
            return;
        }

        switch (evt.charCode || evt.which) {
        case 43: // +
            zoom(1, window.innerWidth / 2, window.innerHeight / 2);
            break;
        case 45: // -
            zoom(-1, window.innerWidth / 2, window.innerHeight / 2);
            break;
        case 61: // =
            player.moveToCurrent();
            break;
        case 70: // F
        case 102: // f
            player.showAll();
            break;
        case 84: // T
        case 116: // t
            toggleFrameList();
            break;
        case 82: // R
            rotate(-1);
            break;
        case 114: // r
            rotate(1);
            break;
        default:
            return;
        }

        evt.stopPropagation();
        evt.preventDefault();
    }

    /**
     * Event handler: key down.
     *
     * &lt;p&gt;Keyboard handling is split into two methods:
     * {@link sozi.actions-onKeyPress} and {@link sozi.actions-onKeyDown}
     * in order to get the same behavior across browsers.&lt;/p&gt;
     *
     * &lt;p&gt;This method handles navigation keys (arrows, page up/down, home, end)
     * and the space and enter keys.&lt;/p&gt;
     *
     * @param {Event} evt The DOM event object
     */
    function onKeyDown(evt) {
        // Keys with Alt/Ctrl/Meta modifiers are ignored
        if (evt.altKey || evt.ctrlKey || evt.metaKey) {
            return;
        }

        switch (evt.keyCode) {
            case 36: // Home
                if (evt.shiftKey) {
                    player.jumpToFirst();
                }
                else {
                    player.moveToFirst();
                }
                break;
            case 35: // End
                if (evt.shiftKey) {
                    player.jumpToLast();
                }
                else {
                    player.moveToLast();
                }
                break;
            case 38: // Arrow up
            case 33: // Page up
            case 37: // Arrow left
                if (evt.shiftKey) {
                    player.jumpToPrevious();
                }
                else {
                    player.moveToPrevious();
                }
                break;
            case 40: // Arrow down
            case 34: // Page down
            case 39: // Arrow right
            case 13: // Enter
            case 32: // Space
                if (evt.shiftKey) {
                    player.jumpToNext();
                }
                else {
                    player.moveToNext();
                }
                break;
            default:
                // Ignore other keys and propagate the event
                return;
        }
        
        // Stop event propagation for supported keys
        evt.stopPropagation();
        
        // In Chrome/Chromium, preventDefault() inhibits the &quot;keypress&quot; event
        evt.preventDefault();
    }

    /**
     * Dummy event handler: stop event propagation.
     *
     * @param {Event} evt The DOM event object
     */
    function stopEvent(evt) {
        evt.stopPropagation();
    }

    /**
     * Event handler: document load.
     *
     * &lt;p&gt;This function sets up all other event handlers for the player.&lt;/p&gt;
     */
    function onDisplayReady() {
        // Prevent event propagation when clicking on a link
        // FIXME does not work in Firefox when the &lt;a&gt; is referenced through a &lt;use&gt;
        var links = document.getElementsByTagName(&quot;a&quot;);
        for (var i = 0; i &lt; links.length; i += 1) {
            links[i].addEventListener(&quot;click&quot;, stopEvent, false);
            links[i].addEventListener(&quot;contextmenu&quot;, stopEvent, false);
        }
        
        // Mouse events are constrained to the player viewport
        // see isPlayerEvent()
        // TODO also use shift-click as an alternative for middle-click
        var svgRoot = document.documentElement;
        svgRoot.addEventListener(&quot;click&quot;, onClick, false);
        svgRoot.addEventListener(&quot;mousedown&quot;, onMouseDown, false);
        svgRoot.addEventListener(&quot;mouseup&quot;, onMouseUp, false);
        svgRoot.addEventListener(&quot;contextmenu&quot;, onContextMenu, false);
        svgRoot.addEventListener(&quot;DOMMouseScroll&quot;, onWheel, false); // Mozilla
        window.onmousewheel = onWheel;

        // Keyboard events are global to the SVG document
        svgRoot.addEventListener(&quot;keypress&quot;, onKeyPress, false);
        svgRoot.addEventListener(&quot;keydown&quot;, onKeyDown, false);
    }

    sozi.events.listen(&quot;sozi.display.ready&quot;, onDisplayReady); // @depend events.js
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.animation
 * @namespace A general-purpose animation controller.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.animation&quot;, function (exports, window) {
    /** @lends sozi.animation */
    
    &quot;use strict&quot;;
    
    /**
     * The browser-specific function to request an animation frame.
     *
     * @function
     */
    var requestAnimationFrame =
            window.mozRequestAnimationFrame ||
            window.webkitRequestAnimationFrame ||
            window.msRequestAnimationFrame ||
            window.oRequestAnimationFrame;

    var getCurrentTime = function () {
        return window.performance &amp;&amp; window.performance.now ?
            window.performance.now() :
            Date.now();
    };

    exports.setAnimationFrameHandlers = function (requestAnimationFrameFunction, getCurrentTimeFunction) {
        requestAnimationFrame = requestAnimationFrameFunction;
        getCurrentTime = getCurrentTimeFunction;
    };

    /**
     * The default time step.
     *
     * &lt;p&gt;For browsers that do not support animation frames.&lt;/p&gt;
     *
     * @constant
     * @type Number
     */
    var TIME_STEP_MS = 40;
    
    /**
     * The handle provided by &lt;code&gt;setInterval()&lt;/code&gt;.
     *
     * &lt;p&gt;For browsers that do not support animation frames.&lt;/p&gt;
     */
    var timer;
    
    /**
     * The list of running animators.
     *
     * @type Array
     */
    var animatorList = [];
    
    /**
     * The main animation loop.
     *
     * &lt;p&gt;This function is called periodically and triggers the
     * animation steps in all running animators.&lt;/p&gt;
     *
     * &lt;p&gt;If all animators are removed from the list of running animators,
     * then the periodic calling is disabled.&lt;/p&gt;
     *
     * &lt;p&gt;This function can be called either through {@link sozi.animation-requestAnimationFrame}
     * if the browser supports it, or through &lt;code&gt;setInterval()&lt;/code&gt;.&lt;/p&gt;
     */
    function loop() {
        if (animatorList.length &gt; 0) {
            // If there is at least one animator,
            // and if the browser provides animation frames,
            // schedule this function to be called again in the next frame.
            if (requestAnimationFrame) {
                requestAnimationFrame(loop);
            }

            // Step all animators
            animatorList.forEach(function (animator) {
                // TODO use timestamp argument:
                // browser compatibility issue with Date.now()
                // and performance.now() timestamps.
                animator.step(getCurrentTime());
            });
        }
        else {
            // If all animators have been removed,
            // and if this function is called periodically
            // through setInterval, disable the periodic calling.
            if (!requestAnimationFrame) {
                window.clearInterval(timer);
            }
        }
    }
    
    /**
     * Start the animation loop.
     *
     * &lt;p&gt;This function delegates the periodic update of all animators
     * to the {@link sozi.animation-loop} function, either through {@link sozi.animation-requestAnimationFrame}
     * if the browser supports it, or through &lt;code&gt;setInterval()&lt;/code&gt;.&lt;/p&gt;
     */
    function start() {
        if (requestAnimationFrame) {
            requestAnimationFrame(loop);
        }
        else {
            timer = window.setInterval(function () {
                loop(getCurrentTime());
            }, TIME_STEP_MS);
        }
    }
    
    /**
     * Add a new animator object to the list of running animators.
     *
     * &lt;p&gt;If the animator list was empty before calling this function,
     * then the animation loop is started.&lt;/p&gt;
     *
     * @param {sozi.animation.Animator} animator The animator object to add.
     */
    function addAnimator(animator) {
        animatorList.push(animator);
        if (animatorList.length === 1) {
            start();
        }
    }
    
    /**
     * Remove the given animator from the list of running animators.
     *
     * @param {sozi.animation.Animator} animator The animator object to add.
     */
    function removeAnimator(animator) {
        animatorList.splice(animatorList.indexOf(animator), 1);
    }
    
    /**
     * @class
     *
     * An animator provides the logic for animating other objects.
     *
     * &lt;p&gt;The main purpose of an animator is to schedule the update
     * operations in the animated objects.&lt;/p&gt;
     *
     * @memberOf sozi.animation
     * @name Animator
     * @depend proto.js
     */
    exports.Animator = sozi.proto.Object.subtype({
        /** @lends sozi.animation.Animator */
        
        /**
         * Construct a new animator.
         */
        construct: function () {
            /**
             * The animation duration, in milliseconds.
             * @type Number
             */
            this.durationMs = 0;
            
            /**
             * A &quot;payload&quot; object that can be used by {@link sozi.animation.Animator.onStep}
             * and {@link sozi.animation.Animator.onDone}.
             */
            this.data = null;
            
            /**
             * The start time of the animation.
             * @type Number
             */
            this.initialTime = 0;
            
            /**
             * The current state of this animator.
             * @type Boolean
             */
            this.started = false;
        },

        /**
         * Start the current animator.
         *
         * &lt;p&gt;The current animator is added to the list of running animators
         * and is put in the &quot;started&quot; state.
         * It will be removed from the list automatically when the given duration
         * has elapsed.&lt;/p&gt;
         *
         * &lt;p&gt;Method {@link sozi.animation.Animator.onStep} is called once before starting the animation.&lt;/p&gt;
         *
         * @param {Number} durationMs The animation duration, in milliseconds
         * @param data Some data that can be used in {@link sozi.animation.Animator.onStep}
         * and {@link sozi.animation.Animator.onDone}
         */
        start: function (durationMs, data) {
            this.durationMs = durationMs;
            this.data = data;
            this.initialTime = getCurrentTime();
            this.onStep(0);
            if (!this.started) {
                this.started = true;
                addAnimator(this);
            }
        },

        /**
         * Stop the current animator.
         *
         * &lt;p&gt;The current animator is removed from the list of running animators
         * and is put in the &quot;stopped&quot; state.&lt;/p&gt;
         */
        stop: function () {
            if (this.started) {
                removeAnimator(this);
                this.started = false;
            }
        },

        /**
         * Perform one animation step.
         *
         * &lt;p&gt;This function is called automatically by the {@link sozi.animation-loop} function.
         * It calls {@link sozi.animation.Animator.onStep}.
         * If the animation duration has elapsed, {@link sozi.animation.Animator.onDone} is called.&lt;/p&gt;
         *
         * @param {Number} currentTime The current time
         */
        step: function (currentTime) {
            var elapsedTime = currentTime - this.initialTime;
            if (elapsedTime &gt;= this.durationMs) {
                this.stop();
                this.onStep(1);
                this.onDone();
            } else {
                this.onStep(elapsedTime / this.durationMs);
            }
        },
        
        /**
         * This method is called automatically on each animation step.
         *
         * &lt;p&gt;The default implementation does nothing. Override it in a
         * subclass or instance to provide your own implementation.&lt;p&gt;
         *
         * @param {Number} progress The elapsed fraction of the total duration (comprised between 0 and 1 included).
         */
        onStep: function (progress) {
            // Do nothing
        },
        
        /**
         * This method is called automatically when the animation ends.
         *
         * &lt;p&gt;The default implementation does nothing. Override it in a
         * subclass or instance to provide your own implementation.&lt;p&gt;
         */
        onDone: function () {
            // Do nothing
        }
    });

    /*
     * The acceleration profiles.
     *
     * Each profile is a function that operates in the interval [0, 1]
     * and produces a result in the same interval.
     *
     * These functions are meant to be called in {@link sozi.animation.Animator.onStep}
     * to transform the progress indicator according to the desired
     * acceleration effect.
     */
    exports.profiles = {
        &quot;linear&quot;: function (x) {
            return x;
        },

        &quot;accelerate&quot;: function (x) {
            return Math.pow(x, 3);
        },

        &quot;strong-accelerate&quot;: function (x) {
            return Math.pow(x, 5);
        },

        &quot;decelerate&quot;: function (x) {
            return 1 - Math.pow(1 - x, 3);
        },

        &quot;strong-decelerate&quot;: function (x) {
            return 1 - Math.pow(1 - x, 5);
        },

        &quot;accelerate-decelerate&quot;: function (x) {
            var xs = x &lt;= 0.5 ? x : 1 - x,
                y = Math.pow(2 * xs, 3) / 2;
            return x &lt;= 0.5 ? y : 1 - y;
        },

        &quot;strong-accelerate-decelerate&quot;: function (x) {
            var xs = x &lt;= 0.5 ? x : 1 - x,
                y = Math.pow(2 * xs, 5) / 2;
            return x &lt;= 0.5 ? y : 1 - y;
        },

        &quot;decelerate-accelerate&quot;: function (x) {
            var xs = x &lt;= 0.5 ? x : 1 - x,
                y = (1 - Math.pow(1 - 2 * xs, 2)) / 2;
            return x &lt;= 0.5 ? y : 1 - y;
        },

        &quot;strong-decelerate-accelerate&quot;: function (x) {
            var xs = x &lt;= 0.5 ? x : 1 - x,
                y = (1 - Math.pow(1 - 2 * xs, 3)) / 2;
            return x &lt;= 0.5 ? y : 1 - y;
        },
        
        &quot;immediate-beginning&quot;: function (x) {
            return 1;
        },
        
        &quot;immediate-end&quot;: function (x) {
            return x === 1 ? 1 : 0;
        },
        
        &quot;immediate-middle&quot;: function (x) {
            return x &gt;= 0.5 ? 1 : 0;
        }
    };
});


/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.display
 * @namespace Display management.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.display&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    // Constant: the Sozi namespace
    var SVG_NS = &quot;http://www.w3.org/2000/svg&quot;;

    var XLINK_NS = &quot;http://www.w3.org/1999/xlink&quot;;
    
    // The global document object
    var document = window.document;
    
    // The initial bounding box of the whole document,
    // assigned in onDocumentReady()
    var initialBBox;
    
    var lastWindowWidth;
    var lastWindowHeight;
    
    exports.viewPorts = {};
    
    var primaryViewport;

    /**
     * @depend proto.js
     */
    exports.CameraState = sozi.proto.Object.subtype({
        construct : function () {
            // Center coordinates
            this.cx = this.cy = 0;
            
            // Dimensions
            this.width = this.height = 1;
            
            // Rotation angle, in degrees
            this.angle = 0;
            
            // Clipping
            this.clipped = true;
            
            // Transition zoom
            this.transitionZoomPercent = 0;
            
            // Transition profile
            this.transitionProfile = sozi.animation.profiles.linear;
            
            // Transition path
            this.transitionPath = null;
        },

        setCenter: function (cx, cy) {
            this.cx = cx;
            this.cy = cy;
            return this;
        },
        
        setSize: function (width, height) {
            this.width = width;
            this.height = height;
            return this;
        },
        
        setClipped: function (clipped) {
            this.clipped = clipped;
            return this;
        },
        
        /*
         * Set the angle of the current camera state.
         * The angle of the current state is normalized
         * in the interval [-180 ; 180]
         */
        setAngle: function (angle) {
            this.angle = (angle + 180) % 360 - 180;
            return this;
        },
        
        setRawAngle: function (angle) {
            this.angle = angle;
            return this;
        },
        
        setTransitionZoomPercent: function (zoomPercent) {
            this.transitionZoomPercent = zoomPercent;
            return this;
        },
        
        setTransitionProfile: function (profile) {
            this.transitionProfile = profile;
            return this;
        },
        
        setTransitionPath: function (svgPath) {
            this.transitionPath = svgPath;
            return this;
        },
        
        /*
         * Set the current camera's properties to the given SVG element.
         *
         * If the element is a rectangle, the properties of the frames are based
         * on the geometrical properties of the rectangle.
         * Otherwise, the properties of the frame are based on the bounding box
         * of the given element.
         *
         * Parameters:
         *    - svgElement: an element from the SVG DOM
         */
        setAtElement: function (svgElement) {
            // Read the raw bounding box of the given SVG element
            var x, y, w, h;
            if (svgElement.nodeName === &quot;rect&quot;) {
                x = svgElement.x.baseVal.value;
                y = svgElement.y.baseVal.value;
                w = svgElement.width.baseVal.value;
                h = svgElement.height.baseVal.value;
            } else {
                var b = svgElement.getBBox();
                x = b.x;
                y = b.y;
                w = b.width;
                h = b.height;
            }

            // Compute the raw coordinates of the center
            // of the given SVG element
            var c = document.documentElement.createSVGPoint();
            c.x = x + w / 2;
            c.y = y + h / 2;
            
            // Compute the coordinates of the center of the given SVG element
            // after its current transformation
            var matrix = svgElement.getCTM();
            c = c.matrixTransform(matrix);

            // Compute the scaling factor applied to the given SVG element
            var scale = Math.sqrt(matrix.a * matrix.a + matrix.b * matrix.b);
            
            // Update the camera to match the bounding box information of the
            // given SVG element after its current transformation
            return this.setCenter(c.x, c.y)
                .setSize(w * scale, h * scale)
                .setAngle(Math.atan2(matrix.b, matrix.a) * 180 / Math.PI);
        },

        setAtState: function (other) {
            return this.setCenter(other.cx, other.cy)
                .setSize(other.width, other.height)
                .setAngle(other.angle)
                .setClipped(other.clipped)
                .setTransitionZoomPercent(other.transitionZoomPercent)
                .setTransitionProfile(other.transitionProfile)
                .setTransitionPath(other.transitionPath);
        },
        
        interpolatableAttributes: [&quot;width&quot;, &quot;height&quot;, &quot;angle&quot;],
        
        interpolate: function (initialState, finalState, ratio, useTransitionPath, reverseTransitionPath) {
            var remaining = 1 - ratio;
            for (var i = 0; i &lt; this.interpolatableAttributes.length; i += 1) {
                var attr = this.interpolatableAttributes[i];
                this[attr] = finalState[attr] * ratio + initialState[attr] * remaining;
            }

            var svgPath = reverseTransitionPath ? initialState.transitionPath : finalState.transitionPath;
            if (useTransitionPath &amp;&amp; svgPath) {
                var pathLength = svgPath.getTotalLength();
                
                if (reverseTransitionPath) {
                    var startPoint = svgPath.getPointAtLength(pathLength);
                    var endPoint = svgPath.getPointAtLength(0);
                    var currentPoint = svgPath.getPointAtLength(pathLength * remaining);
                }
                else {
                    var startPoint = svgPath.getPointAtLength(0);
                    var endPoint = svgPath.getPointAtLength(pathLength);
                    var currentPoint = svgPath.getPointAtLength(pathLength * ratio);
                }
 
                this.cx = currentPoint.x + (finalState.cx - endPoint.x) * ratio + (initialState.cx - startPoint.x) * remaining;
                this.cy = currentPoint.y + (finalState.cy - endPoint.y) * ratio + (initialState.cy - startPoint.y) * remaining;
            }
            else {
                this.cx = finalState.cx * ratio + initialState.cx * remaining;
                this.cy = finalState.cy * ratio + initialState.cy * remaining;
            }
        }
    });
    
    exports.Camera = exports.CameraState.subtype({
        construct: function (viewPort, idLayer) {
            exports.CameraState.construct.call(this);
            
            this.viewPort = viewPort;
            
            // Clipping rectangle
            this.svgClipRect = document.createElementNS(SVG_NS, &quot;rect&quot;);
        
            // Clipping path
            var svgClipPath = document.createElementNS(SVG_NS, &quot;clipPath&quot;);
            svgClipPath.setAttribute(&quot;id&quot;, &quot;sozi-clip-path-&quot; + viewPort.id + &quot;-&quot; + idLayer);
            svgClipPath.appendChild(this.svgClipRect);
            viewPort.svgGroup.appendChild(svgClipPath);

            // The group that will support the clipping operation
            var svgClippedGroup = document.createElementNS(SVG_NS, &quot;g&quot;);
            svgClippedGroup.setAttribute(&quot;clip-path&quot;, &quot;url(#sozi-clip-path-&quot; + viewPort.id + &quot;-&quot; + idLayer + &quot;)&quot;);
            viewPort.svgGroup.appendChild(svgClippedGroup);
            
            if (viewPort.isPrimary) {
                // This group will support transformations
                // we keep the layer group clean since it can be referenced
                // from &lt;use&gt; elements
                this.svgLayer = document.createElementNS(SVG_NS, &quot;g&quot;);
                this.svgLayer.appendChild(document.getElementById(idLayer));
            }
            else {
                // A &lt;use&gt; element referencing the target layer
                this.svgLayer = document.createElementNS(SVG_NS, &quot;use&quot;);
                this.svgLayer.setAttributeNS(XLINK_NS, &quot;href&quot;, &quot;#&quot; + idLayer);
            }
            svgClippedGroup.appendChild(this.svgLayer);
        },
        
        setAtState: function (other) {
            return exports.CameraState.setAtState.call(this, other).update();
        },
        
        getScale: function () {
            return Math.min(this.viewPort.width / this.width, this.viewPort.height / this.height);
        },
        
        rotate: function (angle) {
            return this.setAngle(this.angle + angle).update();
        },

        zoom: function (factor, x, y) {
            return this.setSize(this.width / factor, this.height / factor)
                       .drag(
                            (1 - factor) * (x - this.viewPort.width / 2),
                            (1 - factor) * (y - this.viewPort.height / 2)
                        );
        },
        
        drag: function (deltaX, deltaY) {
            var scale = this.getScale();
            var angleRad = this.angle * Math.PI / 180;
            var si = Math.sin(angleRad);
            var co = Math.cos(angleRad);
            return this.setCenter(
                    this.cx - (deltaX * co - deltaY * si) / scale,
                    this.cy - (deltaX * si + deltaY * co) / scale
                ).setClipped(false).update();
        },

        update: function () {
            var scale = this.getScale();
                    
            // Compute the size and location of the frame on the screen
            var width = this.width  * scale;
            var height = this.height * scale;
            var x = (this.viewPort.width - width) / 2;
            var y = (this.viewPort.height - height) / 2;

            // Adjust the location and size of the clipping rectangle and the frame rectangle
            this.svgClipRect.setAttribute(&quot;x&quot;, this.clipped ? x : 0);
            this.svgClipRect.setAttribute(&quot;y&quot;, this.clipped ? y : 0);
            this.svgClipRect.setAttribute(&quot;width&quot;,  this.clipped ? width  : this.viewPort.width);
            this.svgClipRect.setAttribute(&quot;height&quot;, this.clipped ? height : this.viewPort.height);
                    
            // Compute and apply the geometrical transformation to the layer group
            var translateX = -this.cx + this.width / 2  + x / scale;
            var translateY = -this.cy + this.height / 2 + y / scale;

            this.svgLayer.setAttribute(&quot;transform&quot;,
                &quot;scale(&quot; + scale + &quot;)&quot; +
                &quot;translate(&quot; + translateX + &quot;,&quot; + translateY + &quot;)&quot; +
                &quot;rotate(&quot; + (-this.angle) + ',' + this.cx + &quot;,&quot; + this.cy + &quot;)&quot;
            );
            
            return this;
        }
    });
    
    /**
     * @depend proto.js
     */
    exports.ViewPort = sozi.proto.Object.subtype({
        construct: function (id, idLayerList, primary) {
            this.id = id;
            exports.viewPorts[id] = this;
            
            this.isPrimary = !!primary;
            
            if (this.isPrimary) {
                if (primaryViewport) {
                    throw &quot;Failed to create a primary viewport. A primary viewport already exists.&quot;;
                }
                else {
                    primaryViewport = this;
                }
            }
            
            // TODO add a clip path for the viewport
            this.svgGroup = document.createElementNS(SVG_NS, &quot;g&quot;);
            this.svgGroup.setAttribute(&quot;class&quot;, &quot;sozi-viewport&quot;);
            this.svgGroup.setAttribute(&quot;id&quot;, &quot;sozi-viewport-&quot; + id);
            document.documentElement.appendChild(this.svgGroup);
            
            this.setLocation(0, 0).setSize(window.innerWidth, window.innerHeight);
            
            // Create a camera for each layer
            this.cameras = {};
            idLayerList.forEach(function (idLayer) {
                this.cameras[idLayer] = exports.Camera.instance(this, idLayer);
            }, this);
        },
        
        setSize: function (width, height) {
            this.width = width;
            this.height = height;
            return this;
        },
        
        setLocation: function (x, y) {
            this.x = x;
            this.y = y;
            return this;
        },

        contains: function (x, y) {
            return x &gt;= this.x &amp;&amp; x &lt; this.x + this.width &amp;&amp;
                   y &gt;= this.y &amp;&amp; y &lt; this.y + this.height;
        },
        
        /*
         * Returns the geometrical properties of the SVG document
         *
         * Returns:
         *    - The default size, translation and rotation for the document's bounding box
         */
        getDocumentState: function () {
            // This object defines the bounding box of the whole document
            var camera = exports.CameraState.instance()
                .setCenter(initialBBox.x + initialBBox.width / 2,
                           initialBBox.y + initialBBox.height / 2)
                .setSize(initialBBox.width, initialBBox.height)
                .setClipped(false);
            
            // Copy the document's bounding box to all layers
            var result = {};
            for (var idLayer in this.cameras) {
                result[idLayer] = camera;
            }
            return result;
        },

        /*
         * Apply geometrical transformations to the image according to the current
         * geometrical attributes of this Display.
         *
         * This method is called automatically when the window is resized.
         */
        update: function () {
            this.svgGroup.setAttribute(&quot;transform&quot;, &quot;translate(&quot; + this.x + &quot;,&quot; + this.y + &quot;)&quot;);
            for (var idLayer in this.cameras) {
                this.cameras[idLayer].update();
            }
            return this;
        },

        /*
         * Transform the SVG document to show the given frame.
         *
         * Parameters:
         *    - frame: the frame to show
         */
        showFrame: function (frame) {
            for (var idLayer in frame.states) {
                this.cameras[idLayer].setAtState(frame.states[idLayer]);
            }
            return this;
        },

        /*
         * Apply an additional translation to the SVG document based on onscreen coordinates.
         *
         * Parameters:
         *    - deltaX: the horizontal displacement, in pixels
         *    - deltaY: the vertical displacement, in pixels
         */
        drag: function (deltaX, deltaY) {
            for (var idLayer in this.cameras) {
                this.cameras[idLayer].drag(deltaX, deltaY);
            }
            return this;
        },

        /*
         * Zooms the display with the given factor.
         *
         * The zoom is centered around (x, y) with respect to the center of the display area.
         */
        zoom: function (factor, x, y) {
            for (var idLayer in this.cameras) {
                this.cameras[idLayer].zoom(factor, x, y);
            }
            return this;
        },

        /*
         * Rotate the display with the given angle.
         *
         * The rotation is centered around the center of the display area.
         */
        rotate: function (angle) {
            for (var idLayer in this.cameras) {
                this.cameras[idLayer].rotate(angle);
            }
            return this;
        },
        
        /**
         * The default handler for window resize events.
         *
         * @param widthRatio The horizontal resize ratio
         * @param heightRatio The vertical resize ratio
         */
        onWindowResize: function (widthRatio, heightRatio) {
            this.setLocation(this.x * widthRatio, this.y * heightRatio)
                .setSize(this.width * widthRatio, this.height * heightRatio)
                .update();
        }
    });
    
    /*
     * Initializes the current Display.
     *
     * This method prepares the DOM representation of the current SVG document.
     * All the image is embedded into a global &quot;g&quot; element on which transformations will be applied.
     * A clipping rectangle is added.
     *
     * This method must be called when the document is ready to be manipulated.
     */
    function onDocumentReady() {
        var svgRoot = document.documentElement; // TODO check SVG tag
        
        // Save the initial bounding box of the document
        // and force its dimensions to the browser window
        initialBBox = svgRoot.getBBox();
        lastWindowWidth = window.innerWidth;
        lastWindowHeight = window.innerHeight;
        svgRoot.setAttribute(&quot;width&quot;, lastWindowWidth);
        svgRoot.setAttribute(&quot;height&quot;, lastWindowHeight);
        
        sozi.events.fire(&quot;sozi.display.ready&quot;);
    }

    /*
     * Resizes the SVG document to fit the browser window.
     *
     * This method calls onWindowResize on all registered viewports.
     */
    function resize() {
        var svgRoot = document.documentElement;
        svgRoot.setAttribute(&quot;width&quot;, window.innerWidth);
        svgRoot.setAttribute(&quot;height&quot;, window.innerHeight);
        
        for (var vp in exports.viewPorts) {
            exports.viewPorts[vp].onWindowResize(window.innerWidth / lastWindowWidth, window.innerHeight / lastWindowHeight);
        }

        lastWindowWidth = window.innerWidth;
        lastWindowHeight = window.innerHeight;
    }
    
    sozi.events.listen(&quot;sozi.document.ready&quot;, onDocumentReady); // @depend events.js
    window.addEventListener(&quot;resize&quot;, resize, false);
});

/*
* Sozi - A presentation tool using the SVG standard
*
* Copyright (C) 2010-2013 Guillaume Savaton
*
* This program is dual licensed under the terms of the MIT license
* or the GNU General Public License (GPL) version 3.
* A copy of both licenses is provided in the doc/ folder of the
* official release of Sozi.
*
* See http://sozi.baierouge.fr/wiki/en:license for details.
*/

/**
 * @name sozi.document
 * @namespace Document analysis.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.document&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    // An alias to the global document object
    var document = window.document;
    
    // Constant: the Sozi namespace
    var SOZI_NS = &quot;http://sozi.baierouge.fr&quot;;
    
    // Constant: the default frame properties, if missing in the SVG document
    var DEFAULTS = {
        &quot;title&quot;: &quot;Untitled&quot;,
        &quot;sequence&quot;: &quot;0&quot;,
        &quot;hide&quot;: &quot;true&quot;,
        &quot;clip&quot;: &quot;true&quot;,
        &quot;show-in-frame-list&quot;: &quot;true&quot;,
        &quot;timeout-enable&quot;: &quot;false&quot;,
        &quot;timeout-ms&quot;: &quot;5000&quot;,
        &quot;transition-duration-ms&quot;: &quot;1000&quot;,
        &quot;transition-zoom-percent&quot;: &quot;0&quot;,
        &quot;transition-profile&quot;: &quot;linear&quot;,
        &quot;transition-path-hide&quot;: &quot;true&quot;
    };

    var DRAWABLE_TAGS = [ &quot;g&quot;, &quot;image&quot;, &quot;path&quot;, &quot;rect&quot;, &quot;circle&quot;,
        &quot;ellipse&quot;, &quot;line&quot;, &quot;polyline&quot;, &quot;polygon&quot;, &quot;text&quot;, &quot;clippath&quot; ];

    // The definitions of all valid frames in the current document
    exports.frames = [];
    
    // The list of layer ids managed by Sozi
    exports.idLayerList = [];
    
    /*
    * Returns the value of an attribute of a given Sozi SVG element.
    *
    * If the attribute is empty or does not exist,
    * then a default value is returned (See DEFAULTS).
    */
    function readAttribute(soziElement, attr) {
        return soziElement.getAttributeNS(SOZI_NS, attr) || DEFAULTS[attr];
    }

    function readStateForLayer(frame, idLayer, soziElement) {
        var state = frame.states[idLayer] =
            frame.states[idLayer] || sozi.display.CameraState.instance();
        
        if (typeof state.transitionZoomPercent === &quot;undefined&quot; || soziElement.hasAttributeNS(SOZI_NS, &quot;transition-zoom-percent&quot;)) {
            state.setTransitionZoomPercent(parseInt(readAttribute(soziElement, &quot;transition-zoom-percent&quot;), 10));
        }

        if (typeof state.transitionProfile === &quot;undefined&quot; || soziElement.hasAttributeNS(SOZI_NS, &quot;transition-profile&quot;)) {
            state.setTransitionProfile(sozi.animation.profiles[readAttribute(soziElement, &quot;transition-profile&quot;)]);
        }
        
        if (typeof state.transitionPath === &quot;undefined&quot; || soziElement.hasAttributeNS(SOZI_NS, &quot;transition-path&quot;)) {
            var svgPath = document.getElementById(soziElement.getAttributeNS(SOZI_NS, &quot;transition-path&quot;));
            if (svgPath &amp;&amp; svgPath.nodeName === &quot;path&quot;) {
                state.setTransitionPath(svgPath);
                if (readAttribute(soziElement, &quot;transition-path-hide&quot;) === &quot;true&quot;) {
                    svgPath.style.visibility = &quot;hidden&quot;;
                }
            }
        }
        
        if (soziElement.hasAttributeNS(SOZI_NS, &quot;refid&quot;)) {
            var svgElement = document.getElementById(soziElement.getAttributeNS(SOZI_NS, &quot;refid&quot;));
            if (svgElement) {
                state.setAtElement(svgElement);
                if (readAttribute(soziElement, &quot;hide&quot;) === &quot;true&quot;) {
                    svgElement.style.visibility = &quot;hidden&quot;;
                }
            }
        }
            
        if (soziElement.hasAttributeNS(SOZI_NS, &quot;clip&quot;)) {
            state.setClipped(readAttribute(soziElement, &quot;clip&quot;) === &quot;true&quot;);
        }
    }
    
    /*
    * Builds the list of frames from the current document.
    *
    * This method collects all elements with tag &quot;sozi:frame&quot; and
    * retrieves their geometrical and animation attributes.
    * SVG elements that should be hidden during the presentation are hidden.
    *
    * The resulting list is available in frames, sorted by frame indices.
    */
    function readFrames() {
        // Collect all group ids referenced in &lt;layer&gt; elements
        var idLayerRefList = [];
        var soziLayerList = document.getElementsByTagNameNS(SOZI_NS, &quot;layer&quot;);
        for (var i = 0; i &lt; soziLayerList.length; i += 1) {
            var idLayer = soziLayerList[i].getAttributeNS(SOZI_NS, &quot;group&quot;);
            if (idLayer &amp;&amp; idLayerRefList.indexOf(idLayer) === -1) {
                idLayerRefList.push(idLayer);
            }
        }

        // Reorganize the document, grouping objects that do not belong
        // to a group referenced in &lt;layer&gt; elements
        var svgRoot = document.documentElement;
        var SVG_NS = &quot;http://www.w3.org/2000/svg&quot;;

        // Create the first wrapper group
        var svgWrapper = document.createElementNS(SVG_NS, &quot;g&quot;);

        // For each child of the root SVG element
        var svgElementList = Array.prototype.slice.call(svgRoot.childNodes);
        svgElementList.forEach(function (svgElement, index) {
            if (!svgElement.getAttribute) {
                // Remove text elements
                svgRoot.removeChild(svgElement);
            }
            else if (idLayerRefList.indexOf(svgElement.getAttribute(&quot;id&quot;)) !== -1) {
                // If the current element is a referenced layer ...
                if (svgWrapper.firstChild) {
                    // ... and if there were other non-referenced elements before it,
                    // append the wrapper group to the &lt;defs&gt; element
                    svgWrapper.setAttribute(&quot;id&quot;, &quot;sozi-wrapper-&quot; + index);
                    exports.idLayerList.push(&quot;sozi-wrapper-&quot; + index);
                    svgRoot.insertBefore(svgWrapper, svgElement);
                    
                    // Prepare a new wrapper element
                    svgWrapper = document.createElementNS(SVG_NS, &quot;g&quot;);
                }
                
                // ... append the current element to the &lt;defs&gt; element
                exports.idLayerList.push(svgElement.getAttribute(&quot;id&quot;));
            }
            else if (DRAWABLE_TAGS.indexOf(svgElement.localName.toLowerCase()) !== -1) {
                // If the current element is not a referenced layer
                // and is drawable, move it to the current wrapper element
                svgRoot.removeChild(svgElement);
                svgWrapper.appendChild(svgElement);
            }
        });

        // Append last wrapper if needed
        if (svgWrapper.firstChild) {
            svgWrapper.setAttribute(&quot;id&quot;, &quot;sozi-wrapper-&quot; + svgElementList.length);
            exports.idLayerList.push(&quot;sozi-wrapper-&quot; + svgElementList.length);
            svgRoot.appendChild(svgWrapper);
        }

        
        // Analyze &lt;frame&gt; elements sorted by sequence number
        var soziFrameList = Array.prototype.slice.call(document.getElementsByTagNameNS(SOZI_NS, &quot;frame&quot;));
        soziFrameList.sort(
            function (a, b) {
                var seqA = parseInt(readAttribute(a, &quot;sequence&quot;), 10);
                var seqB = parseInt(readAttribute(b, &quot;sequence&quot;), 10)
                return seqA - seqB;
            }
        );
        
        soziFrameList.forEach(function (soziFrame, indexFrame) {
            var newFrame = {
                id: soziFrame.getAttribute(&quot;id&quot;),
                title: readAttribute(soziFrame, &quot;title&quot;),
                showInFrameList: readAttribute(soziFrame, &quot;show-in-frame-list&quot;) === &quot;true&quot;,
                sequence: parseInt(readAttribute(soziFrame, &quot;sequence&quot;), 10),
                timeoutEnable: readAttribute(soziFrame, &quot;timeout-enable&quot;) === &quot;true&quot;,
                timeoutMs: parseInt(readAttribute(soziFrame, &quot;timeout-ms&quot;), 10),
                transitionDurationMs: parseInt(readAttribute(soziFrame, &quot;transition-duration-ms&quot;), 10),
                states: {}
            };

            // Get the default properties for all layers, either from
            // the current &lt;frame&gt; element or from the corresponding
            // layer in the previous frame.
            // Those properties can later be overriden by &lt;layer&gt; elements
            exports.idLayerList.forEach(function (idLayer) {
                if (indexFrame === 0 || idLayer.search(&quot;sozi-wrapper-[0-9]+&quot;) !== -1) {
                    // In the first frame, or in wrapper layers,
                    // read layer attributes from the &lt;frame&gt; element
                    readStateForLayer(newFrame, idLayer, soziFrame);
                }
                else {
                    // After the first frame, in referenced layers,
                    // copy attributes from the corresponding layer in the previous frame
                    var currentState = newFrame.states[idLayer] = sozi.display.CameraState.instance();
                    var previousState = exports.frames[exports.frames.length - 1].states[idLayer];
                    currentState.setAtState(previousState);
                }
            });

            // Collect and analyze &lt;layer&gt; elements in the current &lt;frame&gt; element
            var soziLayerList = Array.prototype.slice.call(soziFrame.getElementsByTagNameNS(SOZI_NS, &quot;layer&quot;));
            soziLayerList.forEach(function (soziLayer) {
                var idLayer = soziLayer.getAttributeNS(SOZI_NS, &quot;group&quot;);
                if (idLayer &amp;&amp; exports.idLayerList.indexOf(idLayer) !== -1) {
                    readStateForLayer(newFrame, idLayer, soziLayer);
                }
            });
            
            // If the &lt;frame&gt; element has at least one valid layer,
            // add it to the frame list
            for (var idLayer in newFrame.states) {
                if (newFrame.states.hasOwnProperty(idLayer)) {
                    exports.frames.push(newFrame);
                    break;
                }
            }
        });
    }

    /**
     * Return the frame with the given id.
     *
     * @return The index of the frame with the given id. -1 if not found.
     */
    exports.getFrameIndexForId = function (idFrame) {
        for (var indexFrame = 0; indexFrame &lt; exports.frames.length; indexFrame += 1) {
            if (exports.frames[indexFrame].id === idFrame) {
                return indexFrame;
            }
        }
        return - 1;
    };
    
    /*
     * Event handler: document load.
     *
     * This function reads the frames from the document and fires
     * the &quot;documentready&quot; event.
     *
     * @depend events.js
     */
    function onLoad() {
        document.documentElement.removeAttribute(&quot;viewBox&quot;);
        readFrames();
        sozi.events.fire(&quot;sozi.document.ready&quot;);
    }

    window.addEventListener(&quot;load&quot;, onLoad, false);
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.framelist
 * @namespace Show the frame list.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.framelist&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    // An alias to the global document object
	var document = window.document;
	
    // Constant: the margin around the text of the frame list
    var MARGIN = 5;
    
	// The SVG group that will contain the frame list
    var svgTocGroup;
    
    // The SVG group that will contain the frame titles
    var svgTitlesGroup;
    
    // The current height of the frame list,
    // computed during the initialization
    var tocHeight = 0;
    
    // The X coordinate of the frame list in its hidden state
    var translateXHidden;
    
    // The X coordinate of the frame list when it is completely visible
    var translateXVisible;
    
    // The initial X coordinate of the frame list before starting an animation.
    // This variable is set before showing/hiding the frame list.
    var translateXStart;
    
    // The final X coordinate of the frame list for the starting animation.
    // This variable is set before showing/hiding the frame list.
    var translateXEnd;
    
    // The current X coordinate of the frame list for the running animation.
    // This variable is updated on each animation step.
    var translateX;
    
    // The animator object that will manage animations of the frame list
    var animator;
    
    // Constant: the duration of the showing/hiding animation, in milliseconds
    var ANIMATION_TIME_MS = 300;
    
    // Constant: the acceleration profile of the showing/hiding animation
    var ANIMATION_PROFILE = &quot;decelerate&quot;;
    
    // Constant: the SVG namespace
    var SVG_NS = &quot;http://www.w3.org/2000/svg&quot;;

	function onMouseOut(evt) {
        var rel = evt.relatedTarget,
            svgRoot = document.documentElement;
        while (rel &amp;&amp; rel !== svgTocGroup &amp;&amp; rel !== svgRoot) {
            rel = rel.parentNode;
        }
        if (rel !== svgTocGroup) {
            exports.hide();
            sozi.player.restart();
            evt.stopPropagation();
        }
    }

	function onClickArrowUp(evt) {
        var ty = svgTitlesGroup.getCTM().f;
        if (ty &lt;= -window.innerHeight / 2) {
            ty += window.innerHeight / 2;
        } else if (ty &lt; 0) {
            ty = 0;
        }
        svgTitlesGroup.setAttribute(&quot;transform&quot;, &quot;translate(0,&quot; + ty + &quot;)&quot;);
        evt.stopPropagation();
	}

	function onClickArrowDown(evt) {
        var ty = svgTitlesGroup.getCTM().f;
        if (ty + tocHeight &gt;= window.innerHeight * 3 / 2) {
            ty -= window.innerHeight / 2;
        } else if (ty + tocHeight &gt; window.innerHeight + 2 * MARGIN) {
            ty = window.innerHeight - tocHeight - 4 * MARGIN;
        }
        svgTitlesGroup.setAttribute(&quot;transform&quot;, &quot;translate(0,&quot; + ty + &quot;)&quot;);
        evt.stopPropagation();
    }

    /*
     * Create a function that responds to clicks on frame list entries.
     */
    function makeClickHandler(index) {
        return function (evt) {
            sozi.player.previewFrame(index);
            evt.stopPropagation();
        };
    }
    
    /*
     * The default event handler, to prevent event propagation
     * through the frame list.
     */
    function defaultEventHandler(evt) {
	    evt.stopPropagation();
    }
    
    /*
     * Adds a table of contents to the document.
     *
     * The table of contents is a rectangular region with the list of frame titles.
     * Clicking on a title moves the presentation to the corresponding frame.
     *
     * The table of contents is hidden by default.
     */
    function onPlayerReady() {
        svgTocGroup = document.createElementNS(SVG_NS, &quot;g&quot;);
        svgTocGroup.setAttribute(&quot;id&quot;, &quot;sozi-toc&quot;);
        document.documentElement.appendChild(svgTocGroup);

        svgTitlesGroup = document.createElementNS(SVG_NS, &quot;g&quot;);
        svgTocGroup.appendChild(svgTitlesGroup);
    
        // The background rectangle of the frame list
        var tocBackground = document.createElementNS(SVG_NS, &quot;rect&quot;);
        tocBackground.setAttribute(&quot;id&quot;, &quot;sozi-toc-background&quot;);
        tocBackground.setAttribute(&quot;x&quot;, MARGIN);
        tocBackground.setAttribute(&quot;y&quot;, MARGIN);
        tocBackground.setAttribute(&quot;rx&quot;, MARGIN);
        tocBackground.setAttribute(&quot;ry&quot;, MARGIN);
        tocBackground.addEventListener(&quot;click&quot;, defaultEventHandler, false);
        tocBackground.addEventListener(&quot;mousedown&quot;, defaultEventHandler, false);
        tocBackground.addEventListener(&quot;mouseout&quot;, onMouseOut, false);
        svgTitlesGroup.appendChild(tocBackground);

        var tocWidth = 0;
        sozi.document.frames.forEach(function (frame, frameIndex) {
            if (frame.showInFrameList) {
                var text = document.createElementNS(SVG_NS, &quot;text&quot;);
                text.appendChild(document.createTextNode(frame.title));
                text.setAttribute(&quot;id&quot;, &quot;sozi-toc-&quot; + frame.id);
                svgTitlesGroup.appendChild(text);
    
                if (frameIndex === sozi.player.currentFrameIndex) {
                    text.setAttribute(&quot;class&quot;, &quot;sozi-toc-current&quot;);
                }
                         
                var textWidth = text.getBBox().width;
                tocHeight += text.getBBox().height;
                if (textWidth &gt; tocWidth) {
                    tocWidth = textWidth;
                }
    
                text.setAttribute(&quot;x&quot;, 2 * MARGIN);
                text.setAttribute(&quot;y&quot;, tocHeight + MARGIN);
                text.addEventListener(&quot;click&quot;, makeClickHandler(frameIndex), false);
                text.addEventListener(&quot;mousedown&quot;, defaultEventHandler, false);
            }
        });

        // The &quot;up&quot; button
        var tocUp = document.createElementNS(SVG_NS, &quot;path&quot;);
        tocUp.setAttribute(&quot;class&quot;, &quot;sozi-toc-arrow&quot;);
        tocUp.setAttribute(&quot;d&quot;, &quot;M&quot; + (tocWidth + 3 * MARGIN) + &quot;,&quot; + (5 * MARGIN) +
                           &quot; l&quot; + (4 * MARGIN) + &quot;,0&quot; +
                           &quot; l-&quot; + (2 * MARGIN) + &quot;,-&quot; + (3 * MARGIN) +
                           &quot; z&quot;);
        tocUp.addEventListener(&quot;click&quot;, onClickArrowUp, false);
        tocUp.addEventListener(&quot;mousedown&quot;, defaultEventHandler, false);
        svgTocGroup.appendChild(tocUp);

        // The &quot;down&quot; button
        var tocDown = document.createElementNS(SVG_NS, &quot;path&quot;);
        tocDown.setAttribute(&quot;class&quot;, &quot;sozi-toc-arrow&quot;);
        tocDown.setAttribute(&quot;d&quot;, &quot;M&quot; + (tocWidth + 3 * MARGIN) + &quot;,&quot; + (7 * MARGIN) +
                             &quot; l&quot; + (4 * MARGIN) + &quot;,0&quot; +
                             &quot; l-&quot; + (2 * MARGIN) + &quot;,&quot; + (3 * MARGIN) +
                             &quot; z&quot;);
        tocDown.addEventListener(&quot;click&quot;, onClickArrowDown, false);
        tocDown.addEventListener(&quot;mousedown&quot;, defaultEventHandler, false);
        svgTocGroup.appendChild(tocDown);

        tocBackground.setAttribute(&quot;width&quot;, tocWidth + 7 * MARGIN);
        tocBackground.setAttribute(&quot;height&quot;, tocHeight + 2 * MARGIN);
        
        translateXHidden = -tocWidth - 9 * MARGIN;
        translateXVisible = 0;
        translateX = translateXEnd = translateXHidden;
        
        svgTocGroup.setAttribute(&quot;transform&quot;, &quot;translate(&quot; + translateXHidden + &quot;,0)&quot;);
        animator = sozi.animation.Animator.instance().augment({
            onStep: function (progress) {
                var profileProgress = sozi.animation.profiles[ANIMATION_PROFILE](progress),
                    remaining = 1 - profileProgress;
                translateX = translateXEnd * profileProgress + translateXStart * remaining;
                svgTocGroup.setAttribute(&quot;transform&quot;, &quot;translate(&quot; + translateX + &quot;,0)&quot;);
            }
        });
    }

	/*
	 * Highlight the current frame title in the frame list.
	 *
	 * This handler is called on each frame change,
	 * even when the frame list is hidden.
	 */
    function onFrameChange(index) {
        var currentElementList = Array.prototype.slice.call(document.getElementsByClassName(&quot;sozi-toc-current&quot;));
        currentElementList.forEach(function (svgElement) {
            svgElement.removeAttribute(&quot;class&quot;);
        });

        var frame = sozi.document.frames[index];
        if (frame.showInFrameList) {
            document.getElementById(&quot;sozi-toc-&quot; + frame.id).setAttribute(&quot;class&quot;, &quot;sozi-toc-current&quot;);
        }
    }
    
    /*
     * Makes the table of contents visible.
     */
    exports.show = function () {
        // Bring frame list to front
        document.documentElement.appendChild(svgTocGroup);
        
        translateXStart = translateX;
        translateXEnd = translateXVisible;
        animator.start(ANIMATION_TIME_MS); // FIXME depends on current elapsed time
    };

    /*
     * Makes the table of contents invisible.
     */
    exports.hide = function () {
        translateXStart = translateX;
        translateXEnd = translateXHidden;
        animator.start(ANIMATION_TIME_MS); // FIXME depends on current elapsed time
    };

    /*
     * Returns true if the table of contents is visible, false otherwise.
     */
    exports.isVisible = function () {
        return translateXEnd === translateXVisible;
    };

    // @depend events.js
	sozi.events.listen(&quot;sozi.player.ready&quot;, onPlayerReady);
	sozi.events.listen(&quot;sozi.player.cleanup&quot;, exports.hide);
	sozi.events.listen(&quot;sozi.player.framechange&quot;, onFrameChange);
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.framenumber
 * @namespace Show the frame number.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.framenumber&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    // An alias to the global document object
    var document = window.document;
    
    // The SVG group containing the frame number
    var svgGroup;
    
    // The SVG text element and its text node containing the frame number
    var svgText, svgTextNode;
    
    // The SVG circle enclosing the frame number
    var svgCircle;
    
    // Constant: the SVG namespace
    var SVG_NS = &quot;http://www.w3.org/2000/svg&quot;;
    
    function adjust() {
        var textBBox = svgText.getBBox(),
            d = Math.max(textBBox.width, textBBox.height) * 0.75,
            t = d * 1.25;
        svgCircle.setAttribute(&quot;r&quot;, d);
        svgGroup.setAttribute(&quot;transform&quot;, &quot;translate(&quot; + t + &quot;,&quot; + t + &quot;)&quot;);
    }
    
    function onPlayerReady() {
        svgGroup = document.createElementNS(SVG_NS, &quot;g&quot;);
        svgText = document.createElementNS(SVG_NS, &quot;text&quot;);
        svgCircle = document.createElementNS(SVG_NS, &quot;circle&quot;);
        
        svgGroup.setAttribute(&quot;id&quot;, &quot;sozi-framenumber&quot;);

        svgCircle.setAttribute(&quot;cx&quot;, 0);
        svgCircle.setAttribute(&quot;cy&quot;, 0);
        svgGroup.appendChild(svgCircle);
        
        svgTextNode = document.createTextNode(sozi.player.currentFrameIndex + 1);
        svgText.setAttribute(&quot;text-anchor&quot;, &quot;middle&quot;);
        svgText.setAttribute(&quot;dominant-baseline&quot;, &quot;central&quot;);
        svgText.setAttribute(&quot;x&quot;, 0);
        svgText.setAttribute(&quot;y&quot;, 0);
        svgText.appendChild(svgTextNode);
        svgGroup.appendChild(svgText);
        
        document.documentElement.appendChild(svgGroup);
        
        adjust();
    }

    function onFrameChange(index) {
        svgTextNode.nodeValue = index + 1;
    }
    
    // @depend events.js
	sozi.events.listen(&quot;sozi.player.ready&quot;, onPlayerReady);
	sozi.events.listen(&quot;sozi.player.framechange&quot;, onFrameChange);
});

/*
* Sozi - A presentation tool using the SVG standard
*
* Copyright (C) 2010-2013 Guillaume Savaton
*
* This program is dual licensed under the terms of the MIT license
* or the GNU General Public License (GPL) version 3.
* A copy of both licenses is provided in the doc/ folder of the
* official release of Sozi.
*
* See http://sozi.baierouge.fr/wiki/en:license for details.
*/

/**
 * @name sozi.links
 * @namespace Links fix for Webkit.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.links&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    var SVG_NS = &quot;http://www.w3.org/2000/svg&quot;;
    var XLINK_NS = &quot;http://www.w3.org/1999/xlink&quot;;
    
    function getClickHandler(index) {
        return function (evt) {
            sozi.player.moveToFrame(index);
            evt.preventDefault();
            evt.stopPropagation();
        };
    }
    
    /*
     * Event handler: document ready.
     *
     * This function adds an event listener to each internal link.
     * Clicking on a link that targets a frame of this document
     * will call sozi.player.moveToFrame().
     */
    function onDocumentReady() {
        var links = window.document.getElementsByTagNameNS(SVG_NS, &quot;a&quot;);
        for (var i = 0; i &lt; links.length; i += 1) {
            var href = links[i].getAttributeNS(XLINK_NS, &quot;href&quot;);
            if (href &amp;&amp; href[0] === &quot;#&quot;) {
                links[i].addEventListener(&quot;click&quot;, getClickHandler(sozi.location.getFrameIndexForHash(href)), false);
            }
        }
    }

    sozi.events.listen(&quot;sozi.document.ready&quot;, onDocumentReady); // @depend events.js
});


/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.location
 * @namespace Manage the URL in the address bar of the browser window.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.location&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    var changedFromWithin = false;

    /*
     * Returns the frame index corresponding to the URL hash.
     *
     * This is a shortcut for sozi.location.getFrameIndexForHash(window.location.hash)
     */
    exports.getFrameIndex = function () {
        return exports.getFrameIndexForHash(window.location.hash);
    };
    
    /*
     * Returns the frame index corresponding to the given URL hash.
     *
     * The URL hash can be either a frame index or a frame id.
     * In the URL, the frame index starts a 1.
     * This method converts it into a 0-based index.
     *
     * If the URL hash is not a positive integer, then 0 is returned.
     * It the URL hash is an integer greater than the last frame index, then
     * the last frame index is returned.
     */
    exports.getFrameIndexForHash = function (hash) {
        var indexOrId = hash ? hash.slice(1) : &quot;1&quot;;
        var index;
        if (/^[0-9]+$/.test(indexOrId)) {
            index = parseInt(indexOrId, 10) - 1;
        }
        else {
            index = sozi.document.getFrameIndexForId(indexOrId);
        }
        
        if (index &lt; 0) {
            return 0;
        }
        else if (index &gt;= sozi.document.frames.length) {
            return sozi.document.frames.length - 1;
        }
        else {
            return index;
        }
    };

    /*
     * Event handler: hash change.
     *
     * This function is called when the URL hash is changed.
     * If the hash was changed manually in the address bar, and if it corresponds to
     * a valid frame number, then the presentation moves to that frame.
     *
     * The hashchange event can be triggered externally, by the user modifying the URL,
     * or internally, by the script modifying window.location.hash.
     */
    function onHashChange() {
        var index = exports.getFrameIndex();
        if (!changedFromWithin) {
            sozi.player.moveToFrame(index);
        }
        changedFromWithin = false;
    }
    
    /*
     * Event handler: frame change.
     *
     * This function is called when the presentation has reached a new frame.
     * The URL hash is set to the current frame id.
     */
    function onFrameChange(index) {
        changedFromWithin = true;
        window.location.hash = &quot;#&quot; + sozi.document.frames[index].id;
    }

    window.addEventListener(&quot;hashchange&quot;, onHashChange, false);
    sozi.events.listen(&quot;sozi.player.framechange&quot;, onFrameChange); // @depend events.js
});

/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 *
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

/**
 * @name sozi.player
 * @namespace Presentation player.
 * @depend namespace.js
 */
namespace(this, &quot;sozi.player&quot;, function (exports, window) {
    &quot;use strict&quot;;
    
    var viewPort;
    
    // The animator object used to animate transitions
    var animator;
    
    // The handle returned by setTimeout() for frame timeout
    var nextFrameTimeout;
    
    // Constants: default animation properties
    // for out-of-sequence transitions
    var DEFAULT_DURATION_MS = 500;
    var DEFAULT_ZOOM_PERCENT = -10;
    var DEFAULT_PROFILE = &quot;linear&quot;;
    
    // The source frame index for the current transition
    var sourceFrameIndex = 0;
    
    // The index of the visible frame
    exports.currentFrameIndex = 0;
    
    // The state of the presentation.
    // If false, no automatic transition will be fired.
    var playing = false;
    
    // The state of the current frame.
    // If true, an automatic transition will be fired after the current timeout.
    var waiting = false;

    /*
     * Starts waiting before moving to the next frame.
     *
     * It the current frame has a timeout set, this method
     * will register a timer to move to the next frame automatically
     * after the specified time.
     *
     * If the current frame is the last, the presentation will
     * move to the first frame.
     */
    function waitTimeout() {
        if (sozi.document.frames[exports.currentFrameIndex].timeoutEnable) {
            waiting = true;
            var index = (exports.currentFrameIndex + 1) % sozi.document.frames.length;
            nextFrameTimeout = window.setTimeout(function () {
                    exports.moveToFrame(index);
                },
                sozi.document.frames[exports.currentFrameIndex].timeoutMs
            );
        }
    }

    /*
     * Starts the presentation from the given frame index (0-based).
     *
     * This method sets the &quot;playing&quot; flag, shows the desired frame
     * and calls waitTimeout.
     */
    exports.startFromIndex = function (index) {
        playing = true;
        waiting = false;
        sourceFrameIndex = index;
        exports.currentFrameIndex = index;
        viewPort.showFrame(sozi.document.frames[index]);
        waitTimeout();
    };

    exports.restart = function () {
        exports.startFromIndex(exports.currentFrameIndex);
    };

    /*
     * Stops the presentation.
     *
     * This method clears the &quot;playing&quot;.
     * If the presentation was in &quot;waiting&quot; mode due to a timeout
     * in the current frame, then it stops waiting.
     * The current animation is stopped in its current state.
     */
    exports.stop = function () {
        animator.stop();
        if (waiting) {
            window.clearTimeout(nextFrameTimeout);
            waiting = false;
        }
        playing = false;
        sourceFrameIndex = exports.currentFrameIndex;
    };

    function getZoomData(zoomPercent, s0, s1) {
        var result = {
            ss: ((zoomPercent &lt; 0) ? Math.max(s0, s1) : Math.min(s0, s1)) * (100 - zoomPercent) / 100,
            ts: 0.5,
            k: 0
        };

        if (zoomPercent !== 0) {
            var a = s0 - s1;
            var b = s0 - result.ss;
            var c = s1 - result.ss;

            if (a !== 0) {
                var d = Math.sqrt(b * c);

                var u = (b - d) / a;
                var v = (b + d) / a;

                result.ts = (u &gt; 0 &amp;&amp; u &lt;= 1) ? u : v;
            }

            result.k = b / result.ts / result.ts;
        }

        return result;
    }

    /*
     * Jump to a frame with the given index (0-based).
     *
     * This method does not animate the transition from the current
     * state of the display to the desired frame.
     *
     * The presentation is stopped: if a timeout has been set for the
     * target frame, it will be ignored.
     *
     * The URL hash is set to the given frame index (1-based).
     */
    exports.jumpToFrame = function (index) {
        exports.stop();
        sozi.events.fire(&quot;sozi.player.cleanup&quot;);

        sourceFrameIndex = index;
        exports.currentFrameIndex = index;
        viewPort.showFrame(sozi.document.frames[index]);

        sozi.events.fire(&quot;sozi.player.framechange&quot;, index);
    };

    /*
     * Returns an associative array where keys are layer names
     * and values are objects in the form { initialState: finalState: profile: zoomWidth: zoomHeight:}
     */
    exports.getAnimationData = function (initialState, finalState, zoomPercent, profile, useTransitionPath, reverseTransitionPath) {
        var data = {};
        
        for (var idLayer in initialState) {
            data[idLayer] = {
                initialState: sozi.display.CameraState.instance(),
                finalState: sozi.display.CameraState.instance(),
                useTransitionPath: useTransitionPath,
                reverseTransitionPath: reverseTransitionPath
            };
            
            data[idLayer].profile = profile || finalState[idLayer].transitionProfile;
            data[idLayer].initialState.setAtState(initialState[idLayer]);

            // If the current layer is referenced in final state, copy the final properties
            // else, copy initial state to final state for the current layer.
            if (finalState.hasOwnProperty(idLayer)) {
                data[idLayer].finalState.setAtState(finalState[idLayer]);
            }
            else {
                data[idLayer].finalState.setAtState(initialState[idLayer]);
            }

            // Keep the smallest angle difference between initial state and final state
            // TODO this should be handled in the interpolation function
            if (data[idLayer].finalState.angle - data[idLayer].initialState.angle &gt; 180) {
                data[idLayer].finalState.setRawAngle(data[idLayer].finalState.angle - 360);
            }
            else if (data[idLayer].finalState.angle - data[idLayer].initialState.angle &lt; -180) {
                data[idLayer].initialState.setRawAngle(data[idLayer].initialState.angle - 360);
            }

            var zp = zoomPercent || finalState[idLayer].transitionZoomPercent;
            
            if (zp &amp;&amp; finalState.hasOwnProperty(idLayer)) {
                data[idLayer].zoomWidth = getZoomData(zp,
                    initialState[idLayer].width,
                    finalState[idLayer].width);
                data[idLayer].zoomHeight = getZoomData(zp,
                    initialState[idLayer].height,
                    finalState[idLayer].height);
            }
        }
        return data;
    };
    
    exports.previewFrame = function (index) {
        exports.currentFrameIndex = index;
        animator.start(DEFAULT_DURATION_MS,
            exports.getAnimationData(viewPort.cameras, sozi.document.frames[index].states,
                DEFAULT_ZOOM_PERCENT, sozi.animation.profiles[DEFAULT_PROFILE]),
                false, false);
        sozi.events.fire(&quot;sozi.player.framechange&quot;, index);
    };

    /*
     * Moves to a frame with the given index (0-based).
     *
     * This method animates the transition from the current
     * state of the display to the desired frame.
     *
     * If the given frame index corresponds to the next frame in the list,
     * the transition properties of the next frame are used.
     * Otherwise, default transition properties are used.
     */
    exports.moveToFrame = function (index) {
        if (waiting) {
            window.clearTimeout(nextFrameTimeout);
            waiting = false;
        }

        var durationMs, zoomPercent, profile, useTransitionPath, reverseTransitionPath;
        if (index === (exports.currentFrameIndex - 1) % sozi.document.frames.length) {
            durationMs = sozi.document.frames[exports.currentFrameIndex].transitionDurationMs;
            zoomPercent = undefined; // Set for each layer
            profile = undefined; // Set for each layer
            useTransitionPath = true;
            reverseTransitionPath = true;
        }
        else if (index === (exports.currentFrameIndex + 1) % sozi.document.frames.length) {
            durationMs = sozi.document.frames[index].transitionDurationMs;
            zoomPercent = undefined; // Set for each layer
            profile = undefined; // Set for each layer
            useTransitionPath = true;
            reverseTransitionPath = false;
        }
        else {
            durationMs = DEFAULT_DURATION_MS;
            zoomPercent = DEFAULT_ZOOM_PERCENT;
            profile = sozi.animation.profiles[DEFAULT_PROFILE];
            useTransitionPath = false;
            reverseTransitionPath = false;
        }

        sozi.events.fire(&quot;sozi.player.cleanup&quot;);

        playing = true;
        exports.currentFrameIndex = index;

        animator.start(durationMs, exports.getAnimationData(
            viewPort.cameras, sozi.document.frames[index].states,
            zoomPercent, profile,
            useTransitionPath, reverseTransitionPath));

        sozi.events.fire(&quot;sozi.player.framechange&quot;, index);
    };

    /**
     * Jumps to the first frame of the presentation.
     */
    exports.jumpToFirst = function () {
        exports.jumpToFrame(0);
    };
    
    /**
     * Moves to the first frame of the presentation.
     */
    exports.moveToFirst = function () {
        exports.moveToFrame(0);
    };

    /**
     * Jumps to the previous frame.
     */
    exports.jumpToPrevious = function () {
        var index = exports.currentFrameIndex;
        if (!animator.started || sourceFrameIndex &lt;= exports.currentFrameIndex) {
            index -= 1;
        }
        if (index &gt;= 0) {
            exports.jumpToFrame(index);
        }
    };

    /*
     * Moves to the previous frame.
     */
    exports.moveToPrevious = function () {
        for (var index = exports.currentFrameIndex - 1; index &gt;= 0; index -= 1) {
            var frame = sozi.document.frames[index];
            if (!frame.timeoutEnable || frame.timeoutMs !== 0) {
                exports.moveToFrame(index);
                break;
            }
        }
    };

    /**
     * Jumps to the next frame.
     */
    exports.jumpToNext = function () {
        var index = exports.currentFrameIndex;
        if (!animator.started || sourceFrameIndex &gt;= exports.currentFrameIndex) {
            index += 1;
        }
        if (index &lt; sozi.document.frames.length) {
            exports.jumpToFrame(index);
        }
    };

    /**
     * Moves to the next frame.
     */
    exports.moveToNext = function () {
        if (exports.currentFrameIndex &lt; sozi.document.frames.length - 1 || sozi.document.frames[exports.currentFrameIndex].timeoutEnable) {
            exports.moveToFrame((exports.currentFrameIndex + 1) % sozi.document.frames.length);
        }
    };

    /**
     * Jumps to the last frame of the presentation.
     */
    exports.jumpToLast = function () {
        exports.jumpToFrame(sozi.document.frames.length - 1);
    };

    /**
     * Moves to the last frame of the presentation.
     */
    exports.moveToLast = function () {
        exports.moveToFrame(sozi.document.frames.length - 1);
    };

    /*
     * Restores the current frame.
     *
     * This method restores the display to fit the current frame,
     * e.g. after the display has been zoomed or dragged.
     */
    exports.moveToCurrent = function () {
        exports.moveToFrame(exports.currentFrameIndex);
    };

    /*
     * Shows all the document in the browser window.
     */
    exports.showAll = function () {
        exports.stop();
        sozi.events.fire(&quot;sozi.player.cleanup&quot;);
        animator.start(DEFAULT_DURATION_MS,
            exports.getAnimationData(viewPort.cameras, viewPort.getDocumentState(),
                DEFAULT_ZOOM_PERCENT, sozi.animation.profiles[DEFAULT_PROFILE],
                false, false
            )
        );
    };

    /*
     * Event handler: display ready.
     */
    function onDisplayReady() {
        viewPort = sozi.display.ViewPort.instance(&quot;player&quot;, sozi.document.idLayerList, true);
        
        exports.startFromIndex(sozi.location.getFrameIndex());

        // Hack to fix the blank screen bug in Chrome/Chromium
        // See https://github.com/senshu/Sozi/issues/109
        window.setTimeout(viewPort.bind(viewPort.update), 1);
        
        sozi.events.fire(&quot;sozi.player.ready&quot;);
    }

    // TODO move the zoom code to display.js
    exports.onAnimationStep = function (progress, data) {
        for (var idLayer in data) {
            var camera = viewPort.cameras[idLayer];
            
            camera.interpolate(
                data[idLayer].initialState,
                data[idLayer].finalState,
                data[idLayer].profile(progress),
                data[idLayer].useTransitionPath,
                data[idLayer].reverseTransitionPath
            );

            var ps;
            if (data[idLayer].zoomWidth &amp;&amp; data[idLayer].zoomWidth.k !== 0) {
                ps = progress - data[idLayer].zoomWidth.ts;
                camera.width = data[idLayer].zoomWidth.k * ps * ps + data[idLayer].zoomWidth.ss;
            }

            if (data[idLayer].zoomHeight &amp;&amp; data[idLayer].zoomHeight.k !== 0) {
                ps = progress - data[idLayer].zoomHeight.ts;
                camera.height = data[idLayer].zoomHeight.k * ps * ps + data[idLayer].zoomHeight.ss;
            }

            camera.setClipped(data[idLayer].finalState.clipped);
        }

        viewPort.update();
    };
    
    /**
     * @depend animation.js
     */
    animator = sozi.animation.Animator.instance().augment({
        /*
         * Event handler: animation step.
         *
         * This method is called periodically by animator after the animation
         * has been started, and until the animation time is elapsed.
         *
         * Parameter data provides the following information:
         *    - initialState and finalState contain the geometrical properties of the display
         *      at the start and end of the animation.
         *    - profile is a reference to the speed profile function to use.
         *    - zoomWidth and zoomHeight are the parameters of the zooming polynomial if the current
         *      animation has a non-zero zooming effect.
         *
         * Parameter progress is a float number between 0 (start of the animation)
         * and 1 (end of the animation).
         */
        onStep: function (progress) {
            exports.onAnimationStep(progress, this.data);
        },
        
        /*
         * Event handler: animation done.
         *
         * This method is called by animator when the current animation is finished.
         *
         * If the animation was a transition in the normal course of the presentation,
         * then we call the waitTimeout method to process the timeout property of the current frame.
         */
        onDone: function () {
            for (var idLayer in this.data) {
                viewPort.cameras[idLayer].setAtState(this.data[idLayer].finalState);
            }

            viewPort.update();

            sourceFrameIndex = exports.currentFrameIndex;

            if (playing) {
                waitTimeout();
            }
        }
    });

    sozi.events.listen(&quot;sozi.display.ready&quot;, onDisplayReady); // @depend events.js
});

/*
    @depend framenumber.js
    @depend framelist.js
    @depend actions.js
    @depend player.js
    @depend display.js
    @depend document.js
    @depend location.js
    @depend links.js
*/
</script>
  <style
     ns1:version="13.11-30180946"
     id="sozi-style">/*
 * Sozi - A presentation tool using the SVG standard
 *
 * Copyright (C) 2010-2013 Guillaume Savaton
 *
 * This program is dual licensed under the terms of the MIT license
 * or the GNU General Public License (GPL) version 3.
 * A copy of both licenses is provided in the doc/ folder of the
 * official release of Sozi.
 * 
 * See http://sozi.baierouge.fr/wiki/en:license for details.
 */

#sozi-toc text {
   fill: #eff;
   font-family: Verdana, sans-serif;
   font-size: 12pt;
}

#sozi-toc text:hover {
   fill: #0cf;
   cursor: pointer;
}

#sozi-toc text.sozi-toc-current {
   fill: #fa4;
}

#sozi-toc-background {
   stroke: #222;
   stroke-opacity: 0.1;
   stroke-width: 10;
   fill: #222;
   fill-opacity: 0.9;
}

.sozi-toc-arrow {
   fill: #eff;
   fill-opacity: 0.75;
   stroke: none;
}

.sozi-toc-arrow:hover {
   fill: #0cf;
}

#sozi-framenumber circle {
   stroke: #222;
   stroke-opacity: 0.1;
   stroke-width: 4;
   fill: #222;
   fill-opacity: 0.9;
}

#sozi-framenumber text {
   fill: #eff;
   font-family: Verdana, sans-serif;
   font-size: 12pt;
}
</style>
  <ns1:frame
     id="green-frame"
     ns1:transition-path-hide="true"
     ns1:transition-profile="linear"
     ns1:transition-zoom-percent="0"
     ns1:transition-duration-ms="1000"
     ns1:timeout-ms="5000"
     ns1:timeout-enable="false"
     ns1:show-in-frame-list="true"
     ns1:clip="true"
     ns1:hide="true"
     ns1:sequence="3"
     ns1:title="Green"
     ns1:refid="green-rect" />
  <ns1:frame
     id="red-frame"
     ns1:transition-path-hide="true"
     ns1:transition-profile="linear"
     ns1:transition-zoom-percent="0"
     ns1:transition-duration-ms="1000"
     ns1:timeout-ms="5000"
     ns1:timeout-enable="false"
     ns1:show-in-frame-list="true"
     ns1:clip="true"
     ns1:hide="true"
     ns1:sequence="2"
     ns1:title="Red"
     ns1:refid="red-rect" />
  <ns1:frame
     id="black-frame"
     ns1:transition-path-hide="true"
     ns1:transition-profile="linear"
     ns1:transition-zoom-percent="0"
     ns1:transition-duration-ms="1000"
     ns1:timeout-ms="5000"
     ns1:timeout-enable="false"
     ns1:show-in-frame-list="true"
     ns1:clip="true"
     ns1:hide="true"
     ns1:sequence="1"
     ns1:title="Black"
     ns1:refid="black-rect" />
  <ns1:frame
     id="magenta-frame"
     ns1:transition-path-hide="true"
     ns1:transition-profile="linear"
     ns1:transition-zoom-percent="0"
     ns1:transition-duration-ms="1000"
     ns1:timeout-ms="5000"
     ns1:timeout-enable="false"
     ns1:show-in-frame-list="true"
     ns1:clip="true"
     ns1:hide="true"
     ns1:sequence="4"
     ns1:title="Magenta"
     ns1:refid="magenta-rect" />
  <ns1:frame
     id="blue-frame"
     ns1:transition-path-hide="true"
     ns1:transition-profile="linear"
     ns1:transition-zoom-percent="0"
     ns1:transition-duration-ms="1000"
     ns1:timeout-ms="5000"
     ns1:timeout-enable="false"
     ns1:show-in-frame-list="true"
     ns1:clip="true"
     ns1:hide="true"
     ns1:sequence="5"
     ns1:title="Blue"
     ns1:refid="blue-rect" />
</svg>
